(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"/MfA":function(e,t,n){"use strict";(function(e){var r=n("QH1x"),a=n("triP"),i=n("Wwkf"),o=n("ohXN"),s=n("0iYD"),c=n("ziqU"),u=n("Dpii"),l=a.a.play,d=!1,p=s.a.create("Play",{onbeforeremove:function(){d=!1},oninit:function(e){var t=e.attrs.uuid,n=r.a.Plays.list.filter((function(e){return e.uuid=t}));Object.assign(l,i.a.playstatetemplate,{play:n})},view:function(t){var n=t.attrs,r=n.className,a=n.style;return e("div.page.play",{className:r,style:a},d?e(u.b,[e("button.pv1.mh3.mv1",{onclick:function(){return c.a.start(6e4)}},"Controller.start(60secs)"),e("button.pv1.mh3.mv1",{onclick:function(){return c.a.white.move()}},"white.move()"),e("button.pv1.mh3.mv1",{onclick:function(){return c.a.black.move()}},"black.move()"),e("button.pv1.mh3.mv1",{onclick:function(){return c.a.stop()}},"Controller.stop"),e(u.k),e(o.a.comp(),{player:"*"})]):e(u.m,"Please wait..."))}});t.a=p}).call(this,n("mjLj"))},"0+vi":function(e,t,n){"use strict";(function(e){var r=n("XasM").a.connect({name:"analysis-tools"});function a(e,t){var n=e.match(t);return n?n[1]:""}function i(e,t){r("analysis","option",[e,t])}var o={doShow:function(e,t){return function(){return r("board","show",[e,t])}},doMove:function(e){return function(){return r("board","move",[e])}},lan2move:function(e){return{from:e.slice(0,2),to:e.slice(-2)}},parseFen:function(e,t){var n=e.split(" ");return"turn"===t?n[1]:console.log("WTF")},parseInfo:function(e){var t={},n=a(e,/\spv (.*) bmc/),r=a(e,/depth (.*?) .*/),i=a(e,/seldepth (.*?) .*/),o=a(e,/multipv (.*?) .*/),s=a(e,/hashfull (.*?) .*/),c=a(e,/score (.*?) nodes/),u=a(e,/nodes (.*?) .*/),l=a(e,/cp (.*?) .*/),d=a(e,/mate (.*?) .*/),p=a(e,/nps (.*?) .*/),f=a(e,/time (.*?) .*/),h=a(e,/bmc (.*?) .*/);return n&&(t.pv=n),r&&(t.depth=~~r),i&&(t.seldepth=~~i),o&&(t.multipv=~~o),s&&(t.hashfull=~~s),c&&(t.score=c),l&&(t.cp=~~l),d&&(t.mate=~~d),u&&(t.nodes=~~u),p&&(t.nps=~~p),f&&(t.time=~~f),h&&(t.bmc=parseFloat(h)),t},parseOption:function(e){var t=e.join(" "),n=a(t,/name (.*?) type/),r={name:n,line:t,type:a(t,/type (.*?) .*/)},i=a(t,/default (.*?) .*/),o=a(t,/min (.*?) .*/),s=a(t,/max (.*?) .*/);return i&&(r.default=i),o&&(r.default=o),s&&(r.default=s),[n,r]},processors:{id:function(e,t){t.credits=e.slice(1).join(" ")},credits:function(e,t){t.credits=e.join(" ")},bestmove:function(e,t){t.bestmove.move=e[0]||"",t.bestmove.ponder=e[2]||"",t.bestmove.score=e[4]||"none",r("board","bestmove",[{move:o.lan2move(t.bestmove.move),ponder:o.lan2move(t.bestmove.ponder)}])},info:function(e,t){var n=o.parseInfo(e.join(" "));t.info.depth=n.depth,t.info.multipv=n.multipv,t.info.nodes=n.nodes,t.info.nps=n.nps,t.info.hashfull=n.hashfull,t.info.time=n.time,void 0!==n.cp&&t.moves.push(n),void 0!==n.mate&&t.mates.push(n),t.moves.sort((function(e,n){return"w"===t.turn?n.cp-e.cp:e.cp-n.cp})),t.mates.sort((function(e,t){return t.mate-e.mate})),t.moves.length>t.maxpv&&t.moves.pop(),t.mates.length>t.maxmate&&t.mates.pop()}},formatters:{credits:function(t){var n=t.credits;return e("div.ellipsis.eee",[e("span.ph1.c156.fw8","Credits: "),e("span.ph1.eee",n)])},bestmove:function(t){var n="b"===t.turn?"c333":"ceee",r="b"===t.turn?"ceee":"c333";return e("div.fw4",[e("span.ph1.c156.fw8","Best:"),e("span.ph1.".concat(n),t.bestmove.move),e("span.ph1.c156.fw8","ponder"),e("span.ph1.".concat(r),t.bestmove.ponder)])},move:function(t,n){var r=t.moves[n],a="w"===t.turn?"ceee":"c333";return r?e("div",[e("span.ph1.c156","cp:"),e("span.ph1.".concat(a),r.mate||r.cp),e("span.ph1.c156","line:"),e("span.ph1",o.formatters.pv(t,r.pv))]):null},mate:function(t,n){var r=t.mates[n];return r?e("div",[e("span.ph1.c156","mate:"),e("span.ph1.c333",r.mate),e("span.ph1.c156","line:"),e("span.ph1",o.formatters.pv(t,r.pv))]):null},fen:function(t){var n="w"===t.turn?"ceee":"c333";return e("div.ellipsis.eee",[e("span.ph1.c156.fw8","Fen:"),e("span.ph1.".concat(n),t.fen)])},pv:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t.fen,a=o.parseFen(r,"turn"),i=function(e){return n.split(" ").slice(0,e+1)};return n.split(" ").map((function(t,n){var s=n%2==0&&"w"===a?"ceee":n%2==1&&"w"===a||n%2==0&&"b"===a?"c333":n%2==1&&"b"===a?"ceee":console.log("WTF","turn",a,"idx",n,"fen",r);return e("span.ph1.".concat(s,".pointer"),{onclick:o.doMove(i(n)),onmouseover:o.doShow("moves",i(n)),onmouseleave:o.doShow("fen",r)},t)}))},depth:function(t){return e("div.ellipsis.eee",[e("span.ph1.c156.fw8",e.trust("Depth&nbsp;&nbsp;: ")),e("span.ph1.cfe6.fw8.f3.lh1.pointer",{onclick:function(){return i("depth",-1)}},"-"),e("span.ph1.cfe6.fw8",t.info.depth),e("span.ph1.cfe6.fw8.f3.lh1.v-mid.pointer",{onclick:function(){return i("depth",1)}},"+")])},multi:function(t){return e("div.ellipsis.eee",[e("span.ph1.c156.fw8","MultiPV: "),e("span.ph1.".concat("cfe6",".fw8.f3.lh1.pointer"),{onclick:function(){return i("multipv",-1)}},"-"),e("span.ph1.".concat("cfe6",".fw8"),t.info.multipv),e("span.ph1.".concat("cfe6",".fw8.f3.lh1.v-mid.pointer"),{onclick:function(){return i("multipv",1)}},"+")])},info:function(t){var n="w"===status.turn?"ceee":"c333";return e("div.ellipsis.eee",[e("span.ph1.".concat(n),t.info.nodes||0),e("span.c156","nodes, "),e("span.ph1.".concat(n),t.info.nps||0),e("span.c156","nps, "),e("span.ph1.".concat(n),(t.info.hashfull||"0")+"â€°"),e("span.c156.","hash, "),e("span.ph1.".concat(n),(Math.round(t.info.time/100)||"0")/10),e("span.c156","secs")])}}};t.a=o}).call(this,n("mjLj"))},"07Fe":function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n("Mebt"),a=n("NthX"),i=n.n(a),o=n("fFdx"),s=n.n(o),c=n("SDJZ"),u=n.n(c),l=n("NToG"),d=n.n(l),p=n("geNu"),f=n.n(p),h=n("vVKl"),m={cmdType:/^(id|option|uciok$|info|bestmove|Stockfish)/,id:/^id (name|author) (.+)$/,option:/^option name (.+) type (\w+)(?: default ([A-Za-z0-9._\\\:<>/]+))?(?: min (-?\w+))?(?: max (-?\w+))?(?: var (.+))*$/,bestmove:/^bestmove ([A-Za-z0-9\(\)]+)(?: ponder (\w+))?$/,info:{depth:/\bdepth (\d+)/,seldepth:/\bseldepth (\d+)/,time:/\btime (\d+)/,nodes:/\bnodes (\d+)/,currmove:/\bcurrmove (\w+)/,currmovenumber:/\bcurrmovenumber (\d+)/,hashfull:/\bhashfull (\d+)/,nps:/\bnps (\d+)/,tbhits:/\btbhits (\d+)/,cpuload:/\bcpuload (\d+)/,score:/\bscore (cp|mate|lowerbound|upperbound) (-?\d+)/,multipv:/\bmultipv (\d+)/,pv:/\bpv (.+)/,string:/\bstring (.+)/,refutation:/\brefutation (.+)/,currline:/\bcurrline (.+)/}},v=["depth","seldepth","time","nodes","currmovenumber","hashfull","nps","tbhits","cpuload","multipv"];function g(e){var t="go";return["searchmoves","ponder","wtime","btime","winc","binc","movestogo","depth","nodes","mate","movetime","infinite","time"].forEach((function(n){if(void 0!==e[n])switch(n){case"searchmoves":e[n].length&&(t+=" searchmoves "+e[n].join(" "));break;case"ponder":case"infinite":e[n]&&(t+=" ".concat(n));break;default:e[n]>=0&&(t+=" ".concat(n," ").concat(e[n]))}})),t}function b(e){var t=m.bestmove.exec(e);if(t&&t[1]){var n={bestmove:t[1]};return t[2]&&(n.ponder=t[2]),n}}var w=n("nxTg"),y=n.n(w);function k(e){for(var t={},n=0,r=Object.entries(m.info);n<r.length;n++){var a=y()(r[n],2),i=a[0],o=a[1].exec(e);if(o)switch(i){case"score":t[i]={unit:o[1],value:parseFloat(o[2])};break;default:v.includes(i)?t[i]=parseFloat(o[1]):t[i]=o[1]}}if(Object.keys(t).length)return t}function x(e,t){var n=m.cmdType.exec(t);if(!n)return console.log("goReducer.unkown",t),e;switch(n[1]){case"bestmove":var r=b(t);r.bestmove&&(e.bestmove=r.bestmove),r.ponder&&(e.ponder=r.ponder);break;case"info":var a=k(t);a&&e.info.push(a)}return e}var O=n("OvAC"),P=n.n(O);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){P()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t){var n=m.cmdType.exec(t);if(!n)return console.log("initRecucer.unkown",t),e;switch(n[1]){case"id":e.id=S({},e.id,{},function(e){var t=m.id.exec(e);return t&&t[1]&&t[2]?P()({},t[1],t[2]):null}(t));break;case"option":e.options=S({},e.options,{},function(e){var t=m.option.exec(e);if(!t)return null;var n={type:t[2]};switch(t[2]){case"check":n.default="true"===t[3];break;case"spin":n.default=parseInt(t[3]),n.min=parseInt(t[4]),n.max=parseInt(t[5]);break;case"combo":n.default=t[3],n.options=t[6].split(/ ?var ?/g);break;case"string":n.default=t[3]}return P()({},t[1],n)}(t))}return e}var E=n("3EY0"),M=n.n(E),I=function(){function e(t){u()(this,e),this.slot=t,this.options=new Map,this.worker=new M.a}var t,n,r,a,o,c,l,p,v,w,y,O;return d()(e,[{key:"connect",value:function(){this.worker.onmessage=this.listener,this.worker.onerror=this.errorListener,this.worker.onmessageerror=this.errorListener}},{key:"listener",value:function(e){var t=e.data;console.log("engine.listener",t)}},{key:"errorListener",value:function(e){console.warn("engine.errorListener",e)}},{key:"write",value:function(e){h.a.log("engine","".concat(this.slot.name||"unknown",".").concat(this.slot.idx,".write: ")+e),this.worker.postMessage(e)}},{key:"getBufferUntil",value:(O=s()(i.a.mark((function e(t){var n,r,a,o,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],o=new Promise((function(e,i){r=function(r){var a=r.data;if((a=a.trim())&&(n.push(a),t(a)))return e()},a=function(e){console.warn("engine.getBufferUntil",e),i()},s.worker.onmessage=r,s.worker.onerror=a,s.worker.onmessageerror=a})),e.next=4,o;case 4:return this.connect(),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"init",value:(y=s()(i.a.mark((function e(){var t,n,r,a,o=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.connect(),this.write("uci"),e.next=4,this.getBufferUntil((function(e){return"uciok"===e}));case 4:return t=e.sent,n=t.reduce(D,{id:{},options:{}}),r=n.id,a=n.options,r&&(this.id=r),a&&Object.keys(a).forEach((function(e){o.options.set(e,a[e])})),e.abrupt("return",this);case 9:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"isready",value:(w=s()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.write("isready"),e.next=3,this.getBufferUntil((function(e){return"readyok"===e}));case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"sendCmd",value:(v=s()(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.worker){e.next=2;break}throw new Error('cannot call "'.concat(t,'()": worker not running'));case 2:return this.write(t),e.abrupt("return",this.isready());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"setoption",value:(p=s()(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="name "+t,void 0!==n&&(r+=" value ".concat(n.toString())),e.next=4,this.sendCmd("setoption "+r);case 4:return this.options.set(t,n),e.abrupt("return",this);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"ucinewgame",value:(l=s()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sendCmd("ucinewgame"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"ponderhit",value:(c=s()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sendCmd("ponderhit"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"position",value:(o=s()(i.a.mark((function e(t){var n,r,a=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",r="startpos"===t?"startpos":"fen "+t,n.length&&(r+=" moves "+n.join(" ")),e.abrupt("return",this.sendCmd("position "+r));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"go",value:(a=s()(i.a.mark((function e(t){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.worker){e.next=2;break}throw new Error('cannot call "go()": worker not running');case 2:if(!t.infinite){e.next=4;break}throw new Error("go() does not support infinite search, use goInfinite()");case 4:return n=g(t),this.write(n),e.next=8,this.getBufferUntil((function(e){return m.bestmove.test(e)}));case 8:return r=e.sent,a=r.reduce(x,{bestmove:null,info:[]}),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"goInfinite",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.worker)throw new Error('cannot call "goInfinite()": worker not running');this.emitter=new f.a;var n=function(t){t.split(/\r?\n/g).filter((function(e){return!!e.length})).forEach((function(t){var n=k(t);if(n)return e.emitter.emit("data",n);var r=b(t);return r?e.emitter.emit("data",r):void 0}))};t.infinite=!0;var r=g(t);return this.proc.stdout.on("data",n),this.emitter.on("stop",(function(){e.proc.stdout.removeListener("data",n)})),this.write(r),this.emitter}},{key:"stop",value:(r=s()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.emitter){e.next=2;break}throw new Error('cannot call "stop()": goInfinite() is not in progress');case 2:return this.write("stop"),this.emitter.emit("stop"),e.next=6,this.getBufferUntil((function(e){return m.bestmove.test(e)}));case 6:return t=e.sent,n=t.reduce(x,{bestmove:null,info:[]}),e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"evaluate",value:(n=s()(i.a.mark((function e(t){var n,r,a,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{depth:3,maxtime:1},e.next=3,this.isready();case 3:return e.next=5,this.position(t.fen);case 5:return e.next=7,this.go(n);case 7:r=e.sent,"cp"===(a=r.info.slice(-1)[0]).score.unit&&(t.cp=Math.abs(a.score.value)),"mate"===a.score.unit&&(t.mate=a.score.value),t.pv=a.pv;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"evaluateMoves",value:(t=s()(i.a.mark((function e(t,n,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=0;case 1:if(!(a<t.length)){e.next=8;break}return e.next=4,this.evaluate(t[a],n);case 4:r(t[a]);case 5:a++,e.next=1;break;case 8:return e.abrupt("return",this);case 9:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}(),T=r.a.threads-1,L=new Array(T).fill(null).map((function(e,t){return{idx:t,idle:null,engine:null}})),C={sorter:function(e,t){return e&&e.idle&&null===t.engine||e&&e.idle&&t&&!t.idle?-1:t&&t.idle&&null===e.engine||t&&t.idle&&e&&!e.idle?1:0},prepare:function(e){return null===e.engine?(e.engine=new I(e),e.idle=!1,e):e.idle?(e.idle=!1,e):void console.log("WTF")},request:function(e){var t=L.filter((function(e){return null===e.engine||e.idle})).sort(C.sorter).slice(0,e).map(C.prepare);return t.length!==e&&console.warn("pool.request.failed",t.length,"/",e,L,t),t}}},"0MiI":function(e,t,n){"use strict";(function(e){var r=n("e+GP"),a=n.n(r);function i(t,n,r,a,i){return e("div",[t+(n?"[":"{"),e("button",{onclick:function(){return a[r]=!1}},"+"),n?"] ["+i+"]":"}"])}function o(t,n,r,a,i,o,c,u){var l=[];for(var d in l.push(t+(a?"[":"{")),l.push(e("button",{onclick:function(){return o[i]=!0}},"-")),n){var p=n[d],f=r.slice();f.push(d),l.push(s(d,p,f,o,c,u+1))}return l.push(a?"]":"}"),e("div",l)}function s(t,n,r,s,c,u){var l,d,p=null===t?"":t+" : ",f=JSON.stringify(r),h=null!==s[f]?s[f]:r.length>c.collapseAfter;return null!==n&&n instanceof Array?(l=n.length,h?i(p,!0,f,s,l):o(p,n,r,!0,f,s,c,u)):null!==n&&"object"===a()(n)?h?i(p,!1,f,s,u):o(p,n,r,!1,f,s,c,u):(d="function"==typeof n?"function":void 0===n?"undefined":JSON.stringify(n).replace(/"/g,"'"),p=t+" :"+Array(Math.max(1,12-(t||"").length)).fill("&nbsp;").join(""),u<3?e("div.fiob",e.trust(p),e("div.dib.fior.ma0",d)):e("div",e.trust(p+d)))}t.a=function(e){var t=e.attrs.options||{},n={};return{view:function(e){return s(null,e.attrs.tree,[],n,t,0)}}}}).call(this,n("mjLj"))},"0iYD":function(e,t,n){"use strict";var r=n("Jnlq"),a=[],i={onresize:function(){a.forEach((function(e){"function"==typeof e.onresize&&e.onresize(innerWidth,innerHeight)}))},create:function(e,t){var n,i=!1;"function"==typeof t.onregister&&t.onregister((n=e,{send:function(e,t){a.forEach((function(r){r[e]&&"function"==typeof r[e]&&n!==r.name&&r[e]({source:n,msg:t})}))}})),"function"==typeof t.onresize&&t.onresize(innerWidth,innerHeight);var o=r.b.deepFreezeCreate({name:e,oncreate:function(){},onupdate:function(){},onbeforeupdate:function(){return!i},get preventUpdates(){return i},set preventUpdates(e){i=e}},t);return a.push(o),o}};t.a=i},"3EY0":function(e,t,n){e.exports=function(){return new Worker(n.p+"3e3d539777499a554072.worker.js")}},"4Glx":function(e,t,n){"use strict";(function(e){var r=n("hpu3"),a=n("0iYD"),i=n("QH1x"),o=n("Dpii"),s=a.a.create("GamesList",{view:function(t){return e(o.b,{class:"games-list"},t.attrs.games.map((function(t){return e(c,{game:t,onclick:function(e){e.redraw=!1;var n=i.a.Games.get(t.uuid);n?r.c.route("/game/:turn/:uuid/",{uuid:n.uuid,turn:n.turn}):r.c.route("/game/:turn/:uuid/",{uuid:i.a.Games.create(t).uuid})}})})))}}),c=a.a.create("GameEntry",{view:function(t){var n=t.attrs,r=n.game,a=n.onclick,i="".concat(r.white," - ").concat(r.black),o="".concat(r.date," ").concat(r.site," ").concat(r.event),s="";return r.result&&(s+="<b>".concat(r.result,"</b>")+" "),r.termination&&(s+=r.termination+" "),r.timecontrol&&(s+=r.timecontrol+" "),s.length<18&&(o=s+" "+o,s=""),e("div.game-entry",{onclick:a},[e("div.game-line1.f4",i),e("div.game-line2.f5.ellipsis",e.trust(o)),s?e("div.game-line3.f5.ellipsis",e.trust(s)):""])}});t.a=s}).call(this,n("mjLj"))},"4VUy":function(e,t,n){"use strict";(function(e){var r=n("vVKl"),a="";t.a={view:function(){return e("div.w-100",[e("div.w-100.bg-eee",[e("input[type=text].w-100",{style:"background-color: #fff",oninput:function(e){return a=e.target.value+""},value:a,placeholder:"type to search"})]),e("pre.w-100.bg-eee.pl3.viewport-xy",[e.trust(r.a.search(a).slice(0,1e3).join("<br/>"))])])}}}).call(this,n("mjLj"))},"5SGU":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("Jnlq"),a=n("MqTa"),i=n("Wwkf"),o=n("Mebt"),s=function(e){return[{group:"play-s-s",sort:20,title:"Stockfish - Stockfish",active:!0,controls:[{caption:"Depth",sort:10,type:"range",active:!0,value:function(){return e.depth},datalist:r.b.range(1,31).map((function(e){return e%5?{value:e}:{value:e,label:e}})),attributes:{oninput:function(t){var n=~~t.target.value;e.depth=n,e.autosubmit&&e.submit()},min:1,max:30,step:1,list:"dl-stockfish-depth"}},{caption:"Difficulty",sort:20,type:"passive",active:!0,value:function(){return a.a.resolveDifficulty(e.depth)+" ("+e.depth+")"}},{caption:"Timecontrol",sort:30,type:"selectindexed-split",active:!0,options:i.a.timecontrols,value:function(){return e.timecontrol},attributes:{onchange:function(t){e.timecontrol=i.a.timecontrols.find((function(e){return e.idx===~~t.target.value})),e.autosubmit&&e.submit()}}},{caption:"Openings",sort:40,type:"selectindexed-split",active:!0,options:i.a.openings,value:function(){return e.opening},attributes:{onchange:function(t){e.opening=i.a.openings.find((function(e){return e.idx===~~t.target.value})),e.autosubmit&&e.submit()}}},{caption:"Timestamp",sort:50,type:"timestamp",active:!e.autosubmit,value:function(){return e.timestamp},ontick:function(){return e.timestamp=new Date}},{caption:"Play",sort:90,type:"button",active:!e.autosubmit,attributes:{onclick:function(){e.submit(e)}}}]},{group:"play-h-s",sort:30,title:"Human - Stockfish",active:!0,controls:[{caption:"Depth",sort:10,type:"range",active:!0,value:function(){return e.depth},datalist:r.b.range(1,31).map((function(e){return e%5?{value:e}:{value:e,label:e}})),attributes:{oninput:function(t){var n=~~t.target.value;e.depth=n,e.difficulty=a.a.resolveDifficulty(n),e.autosubmit&&e.submit()},min:1,max:30,step:1,list:"dl-stockfish-depth"}},{caption:"Difficulty",sort:20,type:"passive",active:!0,value:function(){return a.a.resolveDifficulty(e.depth)+" ("+e.depth+")"}},{caption:"Timecontrol",sort:30,type:"selectindexed-split",active:!0,options:i.a.timecontrols,value:function(){return e.timecontrol},attributes:{onchange:function(t){e.timecontrol=i.a.timecontrols.find((function(e){return e.idx===~~t.target.value})),e.autosubmit&&e.submit()}}},{caption:"Timestamp",sort:80,type:"timestamp",active:!e.autosubmit,value:function(){return e.timestamp},ontick:function(){return e.timestamp=new Date}},{caption:"Play",sort:90,type:"button",active:!e.autosubmit,attributes:{onclick:function(){e.submit(e)}}}]},{group:"user-data",sort:10,title:"User",active:!0,controls:[{caption:"Name",sort:10,type:"text-split",active:!0,value:function(){return e.name},attributes:{placeholder:"your name",onchange:function(t){e.name=t.target.value,e.autosubmit&&e.submit()}}}]},{group:"board-illustrations",sort:40,title:"Illustrations",active:!0,controls:[{caption:"Best move",sort:10,type:"checkbox",active:!0,value:function(){return e.bestmove},attributes:{type:"checkbox",onchange:function(t){e.bestmove=!!t.target.checked,e.autosubmit&&e.submit()}}},{caption:"Last Move",sort:20,type:"checkbox",active:!0,value:function(){return e.lastmove},attributes:{type:"checkbox",onchange:function(t){e.lastmove=!!t.target.checked,e.autosubmit&&e.submit()}}}]},{group:"game-evaluator",sort:50,title:"Evaluator",active:!0,controls:[{caption:"Max Threads",sort:10,type:"range",active:!0,value:function(){return e.maxthreads},datalist:r.b.range(1,o.a.threads).map((function(e){return{value:e}})),attributes:{oninput:function(t){e.maxthreads=~~t.target.value,e.autosubmit&&e.submit()},min:1,max:o.a.threads-1,step:1,list:"dl-evaluator-threads"}},{caption:"Max Depth",sort:20,type:"number",active:!0,value:function(){return e.maxdepth},dimension:"deep",attributes:{min:1,max:50,step:1,onchange:function(t){e.maxdepth=~~t.target.value,e.autosubmit&&e.submit()}}},{caption:"Max Wait",sort:30,type:"number",active:!0,value:function(){return e.maxsecs},dimension:"secs",attributes:{min:"0.1",max:"5.0",step:"0.1",onchange:function(t){e.maxsecs=parseFloat(t.target.value),e.autosubmit&&e.submit()}}}]},{group:"sources-pgn",sort:60,title:"API Enpoints",active:!0,controls:[{caption:"Endpoint",sort:2,type:"selectindexed",active:!0,options:i.a.apis,value:function(){return e.api},attributes:{onchange:function(t){e.api=i.a.apis.find((function(e){return e.idx===~~t.target.value})),e.autosubmit&&e.submit()}}}]},{group:"ui",sort:70,title:"Other",active:!0,controls:[{caption:"Loader",sort:10,type:"checkbox",active:!0,value:function(){return e.waitscreen},attributes:{type:"checkbox",onchange:function(t){e.waitscreen=!!t.target.checked,e.autosubmit&&e.submit()}}}]}]}},"8B4M":function(e,t,n){},"97EL":function(e,t,n){"use strict";(function(e){var r=n("OvAC"),a=n.n(r),i=n("5WRv"),o=n.n(i),s=n("5SGU"),c=n("Jnlq"),u=n("0iYD");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=c.b.interprete,f=function(){var t,n;return{name:"TimeStamp",oncreate:function(r){var a=r.dom,i=r.attrs;t=a,n=setInterval((function(){e.render(t,c.b.date2isoLocal(new Date)),i.control.ontick()}),1e3)},onremove:function(){clearInterval(n)},view:function(t){return e("div",t.attrs,c.b.date2isoLocal(new Date))}}};function h(t){return e("[",[e("div.group.title.sair",t.title)].concat(o()(t.controls.sort((function(e,t){return e.sort-t.sort})).filter((function(e){return e.active})).map((function(t){return e("div.control",function(t){if("button"===t.type)return t.title?[e("div.control-label-40",t.title),e("div.control-60",e("button.w-100",t.attributes,p(t.caption)))]:[e("div.control-100",e("button.tc.w-100.pv1.ph2",t.attributes,p(t.caption)))];if("passive"===t.type)return[e("div.control-label-40",p(t.caption)),e("div.control-60",p(t.value))];if("timestamp"===t.type)return[e("div.control-label-40",p(t.caption)),e(f,{class:"control-60",control:t})];if("checkbox"===t.type)return t.attributes.checked=p(t.value),[e("div.control-label-40",p(t.caption)),e("div.control-60",e('input[type="checkbox"]',t.attributes))];if("text"===t.type)return t.attributes.value=p(t.value),[e("div.control-label-100",p(t.caption)),e("div.control-100",e('input[type="text"].w-100',t.attributes))];if("text-split"===t.type)return t.attributes.value=p(t.value),[e("div.control-label-40",p(t.caption)),e("div.control-60",e('input[type="text"].w-100',t.attributes))];if("url"===t.type)return t.attributes.value=p(t.value),[e("div.control-label-100",p(t.caption)),e("div.control-60",e('input[type="url"].w-100',t.attributes))];if("colorbox"===t.type)return t.attributes.value=p(t.value),e('input[type="color"]',t.attributes);if("range"===t.type)return t.attributes.value=p(t.value),[e("div.control-label-40",p(t.caption)),e("div.control-60",e('input[type="range"]',t.attributes)),t.attributes.list?e("datalist",{id:t.attributes.list},t.datalist.map((function(t){return e("option",t)}))):e("span")];if("number"===t.type)return t.attributes.value=p(t.value),t.dimension?[e("div.control-label-40",p(t.caption)),e('input[type="number"].w-30',t.attributes),e("div.dimension.w-30",t.dimension)]:[e("div.control-label-40",p(t.caption)),e("div.control-60",e('input[type="number"].w-100',t.attributes))];if("select"===t.type)return[e("div.control-label-100",p(t.caption)),e("div.control-100",e("select.mh3",t.attributes,t.options.map((function(t){return e("option",t)}))))];if("selectindexed"===t.type){var n=p(t.value).idx;return[e("div.control-label-100",p(t.caption)),e("div.tl.f5.pl3.pv2.w-100",e("select.ph2.w-100",{style:"padding-top: 2px; padding-bottom: 2px;"},t.attributes,t.options.map((function(t){return e("option",{value:t.idx,selected:t.idx===n},t.caption)}))))]}if("selectindexed-split"===t.type){var r=p(t.value).idx;return[e("div.control-label-40",p(t.caption)),e("div.control-60",e("select.ph2.w-100",d({style:"padding-top: 2px; padding-bottom: 2px;"},t.attributes),t.options.map((function(t){return e("option",{value:t.idx,selected:t.idx===r},t.caption)}))))]}return t.type+" unknown"}(t))})))))}var m=u.a.create("Forms",{view:function(t){var n=t.attrs.formdata;return e("div.forms",t.attrs,Object(s.a)(n).filter((function(e){return e.group===n.group})).sort((function(e,t){return e.sort-t.sort})).map(h))}});t.a=m}).call(this,n("mjLj"))},"9pvG":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var r=n("0iYD").a.create("Help",{view:function(t){var n=t.attrs.url;return n=decodeURIComponent(n),console.log("info",n),e("iframe.w-100.h-100",{src:"https://en.wikipedia.org/w/index.php?title=Gamergate_controversy&diff=650003294&oldid=649972067",style:"border:0; padding:0"})}})}).call(this,n("mjLj"))},"9ubP":function(e,t,n){"use strict";(function(e){n("j26v");var r=n("MqTa"),a=n("Jnlq"),i=n("XasM"),o=n("QH1x"),s=n("triP"),c=n("Wwkf"),u=n("4Glx"),l=n("0iYD"),d=n("Qie3"),p=n("BwVn"),f=n("Dpii"),h=s.a.game;Object.assign(h,a.b.deepcopy(c.a.gamestatetemplate));var m=i.a.connect({name:"game"}),v=l.a.create("Game",{onupdate:function(){},view:function(t){var n=t.attrs,i=n.className,s=n.style,l=":uuid"===t.attrs.params.uuid?void 0:t.attrs.params.uuid,v=":turn"===t.attrs.params.turn?void 0:~~t.attrs.params.turn;if(!l&&!h.game.uuid)return e("div.page.game",{className:i,style:s},[e(f.n,"Recent Games (DB)"),e(u.a,{games:o.a.Games.list()})]);if(!l&&h.game.uuid)l=h.game.uuid,v=h.game.turn;else if(l!==h.game.uuid){var g=o.a.Games.get(l),b=r.a.genMoves(g.pgn);v=b.length-1,Object.assign(h,a.b.deepcopy(c.a.gamestatetemplate),{game:o.a.Games.update(l,{turn:v,plycount:b.length}),moves:b})}else h.game.turn!==v&&void 0!==v&&(h.game=o.a.Games.update(l,{turn:v}));m("board","game",[h]),r.a.scrollTurnIntoView(h);var w=h.game.white+"<br>"+h.game.black,y=h.game.result+" "+h.game.termination+" "+h.game.timecontrol;return e("div.page.game",{className:i,style:s},[e(p.a),e(f.g,{class:"gm-players"},e.trust(w)),e(d.a),e(f.k),e(p.b),e(f.k),e(f.l,{class:"gm-result",title:"result termination timecontrol"},y),e(f.f)])}});t.a=v}).call(this,n("mjLj"))},B1qE:function(e,t,n){"use strict";(function(e){var r=n("Wwkf"),a=n("triP"),i=n("Jnlq"),o=n("hpu3"),s=a.a.game,c=function(e){return i.b.scale(i.b.clamp(Math.abs(e),.001,s.score.maxcp),0,s.score.maxcp,1,20)},u={name:"Ply",view:function(t){var n=t.attrs,a=n.player,i=n.move,u=n.colbar,l=n.colpiece,d=i.turn!==s.game.turn?".bg-transparent":".bg-89b",p="color:"+r.a.flagColors[a][i.flags],f=function(e){return e.cp&&(e.turn%2==0&&e.cp>0||e.turn%2==1&&e.cp>0)?~~c(e.cp):0}(i),h=r.a.fontPieces[i.piece],m=function(e){e.redraw=!1,o.c.route("/game/:turn/:uuid/",{turn:i.turn,uuid:s.game.uuid},{replace:!0})},v=i.mate?"# in "+Math.abs(i.mate):"",g=i.mate&&i.mate>0?".ceee":".c333",b=r.a.flagTitles[i.flags]+"  ".concat(i.turn),w=i.pv?i.pv.split(" ").slice(0,3).join(" "):"",y=i.pv?i.cp||":"+w:"",k=i.mate&&i.pv?w:"",x=v?k:y;return e("[",[e("td.tc.f4.pa0.chess"+d,{onclick:m,title:b,style:l,"data-turn":i.turn},h),e("td.tl.fiom.f5"+d,{onclick:m,title:b,style:p},i.san),e("td.f6"+d,{style:"min-width: 20px",title:x},[v?e("div"+g,v):e("div.h05"+u,{style:"width:"+f+"px"})])])}};t.a={name:"Move",view:function(t){var n=t.attrs,r=n.num,a=n.white,i=n.black;return e("tr.gm-move.trhover",[e("td",{style:"width: 1rem"}),e("td.tr.fiom.f5.fw8.c555",r+"."),e(u,{move:a.move,player:"w",colpiece:{color:"#eee"},colbar:".bg-ddd"}),e(u,{move:i.move,player:"b",colpiece:{color:"#333"},colbar:".bg-555"}),e("td",{style:"width: 1rem"})])}}}).call(this,n("mjLj"))},BwVn:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return v}));var r,a=n("hpu3"),i=n("wOn7"),o=n("Jnlq"),s=n("triP"),c=n("bdsc"),u=s.a.game,l={name:"GameProgressBar",render:function(e){r&&(r.innerHTML='<div class="gm-progress" style="width:'.concat(e,'%">'))},oncreate:function(e){var t=e.dom;r=t},view:function(){return e("div.gm-bar-progress")}};function d(e){var t=u.game.turn;return"0"===e?0:"e"===e?u.moves.length-1:-2===t&&e<0?-2:t===u.moves.length-1&&e>0?u.moves.length-1:t+e}var p={back:function(e){return e.redraw=!1,a.c.route("/game/:turn/:uuid/",{turn:d("0"),uuid:u.game.uuid},{replace:!0}),o.b.eat(e)},left:function(e){return e.redraw=!1,a.c.route("/game/:turn/:uuid/",{turn:d(-1),uuid:u.game.uuid},{replace:!0}),o.b.eat(e)},right:function(e){return e.redraw=!1,a.c.route("/game/:turn/:uuid/",{turn:d(1),uuid:u.game.uuid},{replace:!0}),o.b.eat(e)},fore:function(e){return e.redraw=!1,a.c.route("/game/:turn/:uuid/",{turn:d("e"),uuid:u.game.uuid},{replace:!0}),o.b.eat(e)},pause:function(e){return o.b.eat(e)},play:function(e){return o.b.eat(e)},eval:function(e){return Object(c.a)(u),o.b.eat(e)},rotate:function(e){return s.a.board.orientation=s.a.board.orientation===i.a.white?i.a.black:i.a.white,o.b.eat(e)},toggle:function(e){return Object(o.a)("section.section-left").classList.toggle("collapsed"),e.redraw=!1,o.b.eat(e)}};function f(e){e.deltaY>0?p.left():p.right()}var h={minimize:{onclick:p.toggle,title:"",tag:"i.gm-button.fa.fa-compress-alt"},maximize:{onclick:p.toggle,title:"",tag:"i.gm-button.fa.fa-compress-alt"},backward:{onclick:p.back,title:"",tag:"i.gm-button.fa.fa-step-backward"},left:{onclick:p.left,title:"",tag:"i.gm-button.fa.fa-chevron-left"},play:{onclick:p.play,title:"",tag:"i.gm-button.fa.fa-play"},pause:{onclick:p.pause,title:"",tag:"i.gm-button.fa.fa-pause"},right:{onclick:p.right,title:"",tag:"i.gm-button.fa.fa-chevron-right"},forward:{onclick:p.fore,title:"",tag:"i.gm-button.fa.fa-step-forward"},evaluate:{onclick:p.eval,title:"",tag:"i.gm-button.fa.fa-poll-h"},spinner:{onclick:function(){},title:"",tag:"i.gm-spinner.fa.fa-spinner.fa-spin"},rotate:{onclick:p.rotate,title:"",tag:"i.gm-button.fa.fa-sync-alt"}},m={name:"GameButtons",onremove:function(){Object(o.a)("div.gm-buttons")&&Object(o.a)("div.gm-buttons").removeEventListener("wheel",f)},oncreate:function(){Object(o.a)("div.gm-buttons")&&Object(o.a)("div.gm-buttons").addEventListener("wheel",f)},onupdate:function(){},view:function(){return e("div.gm-bar",[e("div.gm-buttons.f3",o.b.map(h,(function(t,n){return e(n.tag,{title:n.title,onclick:n.onclick,class:u.buttons[t]?"dib":"dn"})}))),e(l)])}},v={name:"GameFlags",view:function(){return e("div.gm-bar",e("div.gm-flags",o.b.map((t=u.flags,r="c999 bg-999",a="w"===(n=t).turn?"ceee":"c333",{turn:{tag:"i.gm-flag.fa.fa-chess-queen",class:n.over?r:a,title:"turn"},chck:{tag:"i.gm-flag.fa.fa-plus",class:n.chck?a:r,title:"check"},mate:{tag:"i.gm-flag.fa.fa-hashtag",class:n.mate?a:r,title:"checkmate"},draw:{tag:"i.gm-flag.fa.fa-handshake",class:n.draw?"dark-red":r,title:"draw"},stal:{tag:"div.gm-flag.dib.mh1",class:n.stal?"dark-red":r,title:"stalemate"},insu:{tag:"i.gm-flag.fa.fa-hands",class:n.insu?"dark-red":r,title:"isufficient material"},repe:{tag:"i.gm-flag.fa.fa-list-ol",class:n.repe?"dark-red":r,title:"threefold repetition"},over:{tag:"i.gm-flag.fa.fa-chess-board",class:n.over?"dark-red":r,title:"game over"}}),(function(t,n){return e(n.tag,{title:n.title,class:n.class})}))));var t,n,r,a}}}).call(this,n("mjLj"))},CNX3:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,a=n("Jnlq"),i=n("QH1x"),o=n("hpu3"),s=n("triP"),c=n("vdVe"),u=n("0iYD"),l={listen:function(){document.addEventListener("beforeinstallprompt",l.onbeforeinstallprompt),document.addEventListener("selectionchange",l.onselectionchange),document.addEventListener("dblclick",a.b.eat),window.addEventListener("load",o.c.onload),window.addEventListener("beforeunload",l.onbeforeunload),window.addEventListener("online",l.ononline),window.addEventListener("offline",l.onoffline),window.addEventListener("resize",u.a.onresize),window.addEventListener("popstate",c.a.onpopstate),window.addEventListener("hashchange",c.a.onhashchange)},onbeforeinstallprompt:function(e){var t=document.querySelector(".a2hs-button");e.preventDefault(),r=e,t.style.display="block",t.addEventListener("click",(function(){t.style.display="none",r.prompt(),r.userChoice.then((function(e){"accepted"===e.outcome?console.log("User accepted the A2HS prompt"):console.log("User dismissed the A2HS prompt"),r=null}))}))},onpagehide:function(){},onpageshow:function(){},onswipeback:function(e){console.log("events.onswipeBack",e)},onswipefore:function(e){console.log("events.onswipeFore",e)},onbeforeunload:function(){i.a.Usage("lastend",Date.now()),console.log("Bye...")},onselectionchange:function(){console.log("Selection",document.getSelection().toString())},onpopstate:function(){console.log("onpopstate")},ononline:function(){console.log("ononline"),s.a.online=!0},onoffline:function(){console.log("onoffline"),s.a.online=!1},hashchange:function(e){console.log("hashchange",e.oldURL),console.log("hashchange",e.newURL)}};!function(){var e,t=document.createElement("fakeelement");for(e in{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",OTransition:"oTransitionEnd",transition:"transitionEnd"})t.style[e]}()},Dpii:function(e,t,n){"use strict";(function(e){n.d(t,"j",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return b}));n("UdF5");var r=n("Jnlq"),a=n("0iYD"),i=a.a.create("Nothing",{view:function(){return e("div.nothing.dn")}}),o=a.a.create("Spacer",{view:function(t){return e("div.spacer",t.attrs,e.trust("&nbsp;"))}}),s={view:function(t){return e("div.spacer.flex-grow",t.attrs,e.trust("&nbsp;"))}},c={view:function(t){var n=t.attrs.oninput;return e("input[type=text].w-100.mv2",{oninput:n,placeholder:"type to filter"})}},u={view:function(t){return e("div.title-left.tl.saim.white",e("span",t.attrs,t.children))}},l={view:function(t){return e("div.header-left.tl.saim.f3.white",e("span",t.attrs,t.children))}},d={view:function(t){return e("div.text-left.tl.fiom.f4.white",e("span",t.attrs,t.children))}},p={view:function(t){return e("div.text-center.tc.fiom.f4.white",e("span",t.attrs,t.children))}},f={view:function(t){return e("div.header-center.tc.saim.f3.white",t.attrs,e("span",t.children))}},h={view:function(t){return e("div.flexlist",t.attrs,t.children)}},m={view:function(t){return e("div.fixedlist.viewport-y.noselect",t.attrs,t.children)}},v={view:function(t){return e("div.flexlist.flex.flex-column.flex-shrink.viewport-y.noselect",t.attrs,t.children)}},g={view:function(t){var n=t.attrs,r=n.style,a=n.onclick;return e("div.flexlistentry",{style:r,onclick:a},t.children)}},b={view:function(t){var n=t.attrs,a=n.play,i=n.onclick;return e(g,{onclick:i},[e(".fiom.f4",a.white+" vs "+a.black),e(".fior.f5",r.b.date2isoLocal(new Date(a.timestamp))),e(".fior.f5","".concat(a.difficulty," (").concat(a.depth,") / ").concat(a.time," secs"))])}}}).call(this,n("mjLj"))},Ehzf:function(e,t,n){"use strict";(function(e){var r=n("0iYD"),a=n("Jnlq"),i=null,o=r.a.create("Backdrop",{show:function(e){Object(a.a)("back-drop").classList.add("visible"),i=e||null},hide:function(){Object(a.a)("back-drop").classList.remove("visible")},view:function(){return e("back-drop",{onclick:function(e){e.redraw=!1,o.hide(),i&&i()}})}});t.a=o}).call(this,n("mjLj"))},JEw6:function(e,t,n){"use strict";var r=n("wOn7"),a=n("triP"),i=n("MqTa"),o=a.a.board;t.a=function(e,t){return function(n){var a,s;switch(n.type){case r.c.moveStart:return o.moveStart=n.square,!0;case r.c.moveDone:return o.moveStart="",a={from:n.squareFrom,to:n.squareTo},s=i.a.isValid(t,a),i.a.isValid(t,a)?e.move([a]):console.log("illegal: ",a,s),!!s;case r.c.moveCanceled:o.moveStart=""}}}},JSL1:function(e,t,n){"use strict";(function(e){var r=n("NthX"),a=n.n(r),i=n("fFdx"),o=n.n(i),s=n("hpu3"),c=n("qxKj"),u=n("0iYD"),l=n("Dpii"),d=u.a.create("Sources",{view:function(t){var n=t.attrs,r=n.className,i=n.style;return e("div.page.sources",{className:r,style:i},[e(l.n,"Choose a Game Collection"),e(l.b,c.a.list.map((function(t){var n=function(){var e=o()(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.redraw=!1,t.games.length){e.next=7;break}return e.next=4,t.fetch();case 4:t.error||s.c.route("/games/:idx/",{idx:t.idx}),e.next=8;break;case 7:s.c.route("/games/:idx/",{idx:t.idx});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return e(l.c,{onclick:n,class:"sources"},[e("img.source-icon",{src:t.icon}),e("div.source-caption.f4",t.caption),e("div.source-subline.f5.ellipsis",t.subline),t.games.length?e("div.source-loaded",t.games.length+" games loaded"):"",t.error?e("div.source-error.f5",t.error):"",t.progress?e("div.source-progress-on",{style:"width: ".concat(t.progress,"%;")}):e("div.source-progress-off")])}))),e(l.h,"Or download Online Games"),e(l.f)])}});t.a=d}).call(this,n("mjLj"))},Jnlq:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n("nxTg"),a=n.n(r),i=n("e+GP"),o=n.n(i);function s(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a,i=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=document.querySelector.bind(document),l=(document.querySelectorAll.bind(document),{create:function(){var e=arguments.length?Object.assign.apply(null,arguments):{};return Object.setPrototypeOf(e,null),e},clear:function(e){return Object.keys(e).forEach((function(t){return delete e[t]})),e},createFreeze:function(e){return l.freeze(l.create(e))},deepFreezeCreate:function(){var e,t=arguments.length?Object.assign.apply(null,arguments):{},n=Object.getOwnPropertyNames(t),r=s(n);try{for(r.s();!(e=r.n()).done;){var a=e.value,i=t[a];i&&"object"===o()(i)&&(Object.setPrototypeOf(i,null),Object.freeze(i))}}catch(e){r.e(e)}finally{r.f()}return Object.setPrototypeOf(t,null),Object.freeze(t),t},freeze:function(e){return Object.freeze(e)},deepFreeze:function(e){var t,n=s(Object.getOwnPropertyNames(e));try{for(n.s();!(t=n.n()).done;){var r=e[t.value];r&&"object"===o()(r)&&l.deepFreeze(r)}}catch(e){n.e(e)}finally{n.f()}return Object.freeze(e)},each:function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])},strip:function(e){var t=l.create({},e);return Object.entries(t).forEach((function(e){var n=a()(e,1)[0];void 0===t[n]&&delete t[n]})),t},shrink:function(e){return JSON.stringify(l.strip(e)).replace(/"/g,"").slice(0,140)},deepcopy:function(e){return JSON.parse(JSON.stringify(e))},map:function(e,t){var n=[];for(var r in e)n.push(t(r,e[r]));return n},transform:function(e,t){var n=l.create();return Object.keys(e).forEach((function(r){n[r]=t(r,e[r])})),n},range:function(e,t,n){var r,a=[],i=arguments.length;if(0===i)return a;for(1===i&&(t=e,e=0,n=1),2===i&&(n=1),r=e;r<t;r+=n)a.push(r);return a},partitions:function(e,t){var n=[];return l.range(t).forEach((function(){n.push([])})),e.forEach((function(e,r){n[r%t].push(e)})),n},scale:function(e,t,n,r,a){return(a-r)*(e-t)/(n-t)+r},clamp:function(e,t,n){return e<t?t:e>n?n:e},isVisibleInView:function(e,t){if(e&&t){var n=e.getBoundingClientRect(),r=n.top,a=n.bottom,i=n.height,o=t.getBoundingClientRect();return r<=o.top?o.top-r<=i:a-o.bottom<=i}return!0},format:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=0,i=e.split("%s");return i.map((function(e){return e+(n[a++]||"")})).join("")},padZero:function(e,t){return("000000"+e).slice(-(t||2))},hash:function(e){var t,n=0;if(0==e.length)return n.toString(36);for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n&=n;return n.toString(36)},uuid:function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var n=e.join("");return n},shortuuid:function(){var e=4665679*Math.random()|0,t=4665679*Math.random()|0;return(e=("0000"+e.toString(36)).slice(-4))+(t=("0000"+t.toString(36)).slice(-4))},sleep:function(e){return new Promise((function(t){return setTimeout(t,e)}))},msec2HMSm:function(e){var t=new Date(e);return[l.padZero(t.getUTCHours()),l.padZero(t.getUTCMinutes()),l.padZero(t.getUTCSeconds())].join(":")+"."+Math.floor(t.getMilliseconds()/100)},msec2HMS:function(e){var t=new Date(e);return[l.padZero(t.getUTCHours()),l.padZero(t.getUTCMinutes()),l.padZero(t.getUTCSeconds())].join(":")},date2isoUtc:function(e){var t=e||new Date;return[t.getUTCFullYear(),l.padZero(t.getUTCMonth()+1),l.padZero(t.getUTCDate())].join("-")+" "+[l.padZero(t.getUTCHours()),l.padZero(t.getUTCMinutes()),l.padZero(t.getUTCSeconds())].join(":")},date2isoLocal:function(e){var t=e||new Date;return[t.getFullYear(),l.padZero(t.getMonth()+1),l.padZero(t.getDate())].join("-")+" "+[l.padZero(t.getHours()),l.padZero(t.getMinutes()),l.padZero(t.getSeconds())].join(":")},eat:function(e){return e.preventDefault(),e.stopPropagation(),!1},interprete:function(e){return"function"==typeof e?e():e},msecs2human:function(e){function t(e){return e>1?"s":""}var n=Math.floor(e/1e3),r=Math.floor(n/31536e3);if(r)return r+" year"+t(r);var a=Math.floor((n%=31536e3)/86400);if(a)return a+" day"+t(a);var i=Math.floor((n%=86400)/3600);if(i)return i+" hour"+t(i);var o=Math.floor((n%=3600)/60);if(o)return o+" minute"+t(o);var s=n%60;return s?s+" second"+t(s):"less than a second"}})},Mebt:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n("e+GP"),i=n.n(a),o={plattform:navigator.platform,userAgent:navigator.userAgent,threads:navigator.hardwareConcurrency,vendor:navigator.vendor,touch:"ontouchstart"in document.documentElement,fetch:!!window.fetch,online:!!Navigator.onLine,languages:navigator.languages.join("|"),vibration:!!window.navigator.vibrate,localStorage:!!window.localStorage,serviceWorker:!!navigator.serviceWorker,fullscreen:!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.documentElement.webkitRequestFullScreen),wasm:"object"===("undefined"==typeof WebAssembly?"undefined":i()(WebAssembly))&&WebAssembly.validate(Uint8Array.of(0,97,115,109,1,0,0,0)),is64bit:function(){for(var e=0,t=["x86_64","x86-64","Win64","x64","amd64","AMD64"];e<t.length;e++){var n=t[e];if(navigator.userAgent.indexOf(n)>=0)return!0}return"Linux x86_64"===navigator.platform||"MacIntel"===navigator.platform||"Linux aarch64"===navigator.platform}(),screen:{width:screen.width,height:screen.height,aspect:screen.width/screen.height,availWidth:screen.availWidth,availHeight:screen.availHeight,get innerWidth(){return innerWidth},get innerHeight(){return innerHeight},colorDepth:screen.colorDepth,pixelDepth:screen.pixelDepth,left:screen.left,top:screen.top,devicePixelRatio:window.devicePixelRatio,"safe-area-inset-top":getComputedStyle(document.documentElement).getPropertyValue("--sat"),"safe-area-inset-right":getComputedStyle(document.documentElement).getPropertyValue("--sar"),"safe-area-inset-bottom":getComputedStyle(document.documentElement).getPropertyValue("--sab"),"safe-area-inset-left":getComputedStyle(document.documentElement).getPropertyValue("--sal")},Atomics:"object"===("undefined"==typeof Atomics?"undefined":i()(Atomics)),SharedArrayBuffer:"function"==typeof SharedArrayBuffer,OffscreenCanvas:"function"==typeof OffscreenCanvas,sharedMemory:function(){try{r=new WebAssembly.Memory({shared:!0,initial:8,maximum:16})}catch(e){return!1}return!0}(),cloning:function(){try{window.postMessage(r,"*")}catch(e){return!1}return!0}(),growable:function(){try{r.grow(8)}catch(e){return!1}return!0}(),SharedMemory:function(){try{return r.buffer instanceof SharedArrayBuffer}catch(e){return!1}}(),transitionEnd:function(){var e,t=document.createElement("div"),n={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(n.hasOwnProperty(e)&&void 0!==t.style[e])return n[e]}(),log:function(){var e=o;console.log("Info   :",navigator.hardwareConcurrency+" Threads","LS"+(e.hasLocalStorage?"+":"-"),"FS"+(e.fullscreenEnabled?"+":"-"),"SM"+(e.sharedMemory?"+":"-"),"SAB"+(e.SharedArrayBuffer?"+":"-"),"wasm"+(e.wasmSupported?"+":"-"),"64bit"+(e.is64Bit?"+":"-"),"Atoms"+(e.Atomics?"+":"-"),"Clones"+(e.cloning?"+":"-"),"Growables"+(e.growable?"+":"-"),"OSCanvas"+(e.OffscreenCanvas?"+":"-"))}};o.log()},MqTa:function(e,t,n){"use strict";var r=n("OvAC"),a=n.n(r),i=n("0+vi"),o=n("uoUx"),s=n.n(o),c=n("wOn7"),u=n("XasM"),l=n("triP"),d=n("Wwkf"),p=u.a.connect({name:"board-tools"}),f={isValid:function(e,t){var n=new s.a;return n.load(e.fen()),n.move(t)?n.fen():""},updateMarker:function(e,t,n){var r=e.moves({verbose:!0}),a="w"===e.turn()?c.d.rectwhite:c.d.rectblack;t.removeMarkers(null,null),n.illustrations.marker.attack&&r.forEach((function(e){t.addMarker(e.to,a)}))},updateArrows:function(e,t,n){var r=e.history({verbose:!0}).slice(-2),a=n.illustrations.arrows;if(t.removeArrows(null),a.bestmoves){var i=n.bestmove.move,o=n.bestmove.ponder;i.from&&o.from&&(t.addArrow(o.from,o.to,{class:"arrow ponder"}),t.addArrow(i.from,i.to,{class:"arrow bestmove",onclick:function(){p("board","move",[[a.bestmove.move]])}}))}a.validmoves&&a.moveStart&&e.moves({verbose:!0}).filter((function(e){return e.from===a.moveStart})).forEach((function(e){t.addArrow(e.from,e.to,{class:"arrow validmove"})})),a.pinned&&t.addArrow("c1","c8",{class:"arrow pinned"}),a.last&&r.forEach((function(e){t.addArrow(e.from,e.to,{class:"w"===e.color?"arrow last-white":"arrow last-black"})})),a.test&&(t.addArrow("e2","e4",{class:"arrow test"}),t.addArrow("f2","h4",{class:"arrow test"}),t.addArrow("d2","c4",{class:"arrow test"}),t.addArrow("c2","a3",{class:"arrow test"}),t.addArrow("d7","d5",{class:"arrow test"}),t.addArrow("c7","c5",{class:"arrow test"}),t.addArrow("g7","g8",{class:"arrow test"}),t.addArrow("g7","h8",{class:"arrow test"}),t.addArrow("g7","h7",{class:"arrow test"}),t.addArrow("g7","h6",{class:"arrow test"}),t.addArrow("g7","g6",{class:"arrow test"}),t.addArrow("g7","f6",{class:"arrow test"}),t.addArrow("g7","f7",{class:"arrow test"}),t.addArrow("g7","f8",{class:"arrow test"}))},genMoves:function(e){if(""===e)return[];var t=new s.a,n=new s.a;return!t.load_pgn(e)&&console.warn("boardtools.load.pgn.failed",e),t.history({verbose:!0}).map((function(e,t){return n.move(e),e.fen=n.fen(),e.turn=t,e}))},updateFlags:function(e){var t=l.a.game.flags;t.turn=e.turn(),t.over=e.game_over(),t.chck=e.in_check(),t.mate=e.in_checkmate(),t.draw=e.in_draw(),t.stal=e.in_stalemate(),t.insu=e.insufficient_material(),t.repe=e.in_threefold_repetition()},genCapturedPieces:function(e){var t=function(e,t){return d.a.pieces.fens.sorted.indexOf(e.toLowerCase())-d.a.pieces.fens.sorted.indexOf(t.toLowerCase())},n=d.a.pieces.fens.black,r=d.a.pieces.fens.white;return e.split(" ")[0].split("").forEach((function(e){n=n.replace(e,""),r=r.replace(e,"")})),n=n.split("").sort(t).map((function(e){return d.a.fontPieces[e]})),r=r.split("").sort(t).map((function(e){return d.a.fontPiecesWhite[e]})),{blacks:n,whites:r}},squareIndexToField:function(e){var t=Math.floor(e/8)+1,n=e%8;return String.fromCharCode(97+n)+t}},h=new s.a,m={lastMovePointer:function(e){return e.length%2==0?"b"+(~~(e.length/2)-1):"w"+~~(e.length/2)},gameLength:function(e){return""===e.pgn?0:(!h.load_pgn(e.pgn)&&console.warn("gameLength.error",e),h.history().length)},turn2pointer:function(e){return(~~e%2==0?"w":"b")+(Math.floor(~~e/2)+1)}},v=n("Jnlq");function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var b={interpolate:function(e,t){var n=e;return v.b.each(t,(function(e,t){n=n.replace(":"+e,t)})),n},scrollTurnIntoView:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;e.moves.length&&setTimeout((function(){var t='td[data-turn="'+e.game.turn+'"]',n=v.b.isVisibleInView(Object(v.a)(t),Object(v.a)("div.gm-moves"));t||console.warn("scrollIntoView",t,"div.gm-moves"),!n&&Object(v.a)(t)&&Object(v.a)(t).scrollIntoView(!0)}),t)},genGameHash:function(e){var t=JSON.stringify({1:e.header.White,2:e.header.Black,3:e.header.Event,4:e.header.Site,5:e.header.Date,6:e.header.Result,7:e.pgn.slice(0,20)});return v.b.hash(t)},resolveDifficulty:function(e){var t=d.a.plays.difficulties,n=t[0],r=n;return v.b.range(0,31).forEach((function(a){n=t[a]?t[a]:n,r=~~a<=e?n:r})),r},resolvePlayers:function(e){var t=d.a.opponents,n=e.mode[0],r=e.mode[2];return{white:t[n],black:t[r]}},createPlayTemplate:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({uuid:v.b.shortuuid(),turn:0},b.resolvePlayers(e),{},t,{},e,{difficulty:b.resolveDifficulty(t.depth),pgn:""})}};function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},i.a,{},f,{},m,{},b)},QH1x:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("tNDA"),a=n("Jnlq"),i=n("Mebt"),o={"user-data":{name:"noiv"},"play-h-s":{depth:3,timecontrol:{idx:0,caption:"10 secs",value:"".concat(1e4,"|0")},opening:{idx:0,label:"OP01"}},"play-s-s":{depth:3,timecontrol:{idx:0,caption:"10 secs",value:"".concat(1e4,"|0")},opening:{idx:0,label:"OP01"}},"game-evaluator":{engine:"stockfish",maxthreads:2,maxdepth:5,maxsecs:1,divisor:2},"board-illustrations":{pinning:!0,bestmove:!0,ponder:!0,lastmove:!0,availmoves:!0,attack:!0,valid:!0},"board-decoration":{decoration:!1,"light-color":"#789","dark-color":"#987"},ui:{waitscreen:!0},other:{"ui-collapsed":{"section-left":!1}}},s={dump:function(){console.log(JSON.stringify(localStorage,null,2).replace(/\\"/g,"'"))},all:function(){return{usage:r("usage"),options:r("options"),plays:r("plays"),games:r("games")}},reset:function(){console.log("Info   :","Caissa first use, resetting DB..."),r.clear(),r.set("plays",[]),r.set("games",[]),r.set("options",o),r.set("usage",{laststart:Date.now(),lastend:Date.now(),usage:0})},init:function(){try{if(i.a.localStorage||console.error("Info   :","BE","localStorage not available"),r("usage")){var e=r("usage"),t=r("options"),n=a.b.msecs2human(Date.now()-e.lastend);e.usage+=1,e.laststart=Date.now(),e.lastend=Date.now(),r("usage",e),console.log("Info   :","DB",s.Games.length,"games","user:",t["user-data"].name,"usage:",e.usage,"last:",n,"ago")}else s.reset()}catch(e){console.warn("db.init.error",e)}},Usage:function(e,t){var n=r("usage");n[e]=t,r("usage",n)},XOptions:{},get Options(){return r("options")},updateOption:function(e){var t=r("options");Object.assign(t,e),r("options",t),console.log("updateOption",a.b.shrink(e))},Forms:{save:function(e,t){var n=Date.now(),a=r("options");a[e]=t,r("options",a),console.log("DB.Forms.save",e,t,Date.now()-n,"msecs")}},Plays:{get list(){return r("plays")},get length(){return r("plays").length},clear:function(){r("plays",[])},save:function(e){!r("plays",e)&&console.warn("db.plays.save.failed",e)},create:function(e){var t=r("plays"),n=t.push(e);return s.Plays.save(t),console.log("db.plays.created",{uuid:e.uuid},"having",n),e},update:function(e,t){var n=r("plays"),a=n.find((function(t){return t.uuid===e}));return Object.assign(a,t),s.Plays.save(n),a}},Games:{clear:function(){r.set("games",[])},save:function(e){!r("games",e)&&console.warn("db.games.save.failed",e)},create:function(e){var t=r("games"),n=t.find((function(t){return t.uuid===e.uuid}));return n?(s.Games.update(n.uuid,e),console.log("db.games.overwrote",{uuid:e.uuid}),e):(t.push(e),s.Games.save(t),e)},update:function(e,t){var n=r("games"),a=n.find((function(t){return t.uuid===e}));return Object.assign(a,t),s.Games.save(n),a},get:function(e){var t=r("games").find((function(t){return t.uuid===e}));return t||null},list:function(){return r("games")},get length(){return r("games").length}}};s.init()},QfWi:function(e,t,n){"use strict";n.r(t),function(e,t){n("iPZ8"),n("kypl"),n("KcJv"),n("XJHa"),n("NO6N"),n("pCzD"),n("aNIS"),n("u1l9"),n("UHK9"),n("qO//"),n("ag/i"),n("26qs"),n("XXOr"),n("NISO"),n("11tc"),n("hi3g"),n("KnrE"),n("7qfE"),n("C4nn"),n("lYjL"),n("IlJM"),n("FWxf"),n("Se8w"),n("SJSz"),n("RtS0"),n("4owi"),n("IvQZ"),n("uQK7"),n("o5JG"),n("/YXa"),n("8cZI"),n("8rZV"),n("lmye"),n("hTH9"),n("x3Br"),n("8Av2"),n("Tsb7"),n("WB5j"),n("lAJ5"),n("aOEW"),n("v+MS"),n("Xlt+"),n("bEJU"),n("RsBt"),n("F4s9"),n("op7M"),n("JT/7"),n("1sJv"),n("6QkG"),n("pKr/"),n("RWcT"),n("X21e"),n("ZXyM"),n("GCui"),n("iXYm"),n("D/wG"),n("Ut8V"),n("1Z5j"),n("1Qwx"),n("pJGf"),n("ArYU"),n("NZIh"),n("526l"),n("akAd"),n("JLHK"),n("ekdp"),n("IfeN"),n("Pe4Z"),n("TlnR"),n("wObw"),n("Rl66"),n("eUWX"),n("uAsx"),n("VyG4"),n("uJcu"),n("aR7f"),n("x+Sn"),n("fp7Y"),n("xeeI"),n("Pgdl"),n("ydrk"),n("SQIU"),n("i+rb"),n("ZJUF"),n("Nfll"),n("LW6M"),n("+XsM"),n("ZEAQ"),n("6uKX"),n("wCa+"),n("wk30"),n("PTK/"),n("c5sl"),n("EQuw"),n("dhi5"),n("zSSO"),n("u/xS"),n("ZrY6"),n("PM3k"),n("m37F"),n("Y4kN"),n("o9/u"),n("yEA/"),n("1ihM"),n("hKfv"),n("FOvO"),n("SUr3"),n("E/vp"),n("S/BG"),n("o29/"),n("RrfL"),n("4GBK"),n("JBxO"),n("JjHl"),n("St4I"),n("yPLR"),n("FdtR"),n("Ffmu"),n("QDHd"),n("oLsI"),n("AHPp"),n("bggm"),n("L0xw"),n("enkF"),n("i6eu"),n("dQW1"),n("hMrN"),n("9R9e"),n("YVp5"),n("btft"),n("NRL2"),n("SB7D"),n("CfbV"),n("Muwe"),n("M9Nf"),n("9UJh"),n("RsMT"),n("VyTv"),n("dYvz"),n("6Uyv"),n("4NM0"),n("WoWj"),n("w13K"),n("9yb3"),n("uXbS"),n("e+qc"),n("ZAKC"),n("chvs"),n("y89P"),n("X5mX"),n("aZFp"),n("MTDe"),n("SgDD"),n("F28z"),n("W7E7"),n("zSDB"),n("mslO"),n("HAuY"),n("D5rU"),n("6lz5"),n("jqTn"),n("eyPT"),n("ApFe"),n("y8Ly"),n("YySF"),n("Kxz6"),n("DnCL"),n("veAN"),n("D0Fs"),n("APoS"),n("uTy6"),n("pY4j"),n("Nu6h"),n("kPpV"),n("q2Qn"),n("W9dP"),n("OlPo"),n("/usm"),n("HJh7"),n("BqNe"),n("HKDy"),n("OgzJ"),n("lCat"),n("EApN"),n("0w+R"),n("MFGm"),n("lZgT"),n("JzGb"),n("WH+p"),n("xg3p"),n("soU3"),n("/xTX"),n("ajWl"),n("s5En"),n("EjQN"),n("36lJ"),n("fD/E"),n("LWud"),n("AxL9"),n("HztR"),n("xmYR"),n("cF0Y"),n("qoNQ"),n("rTzs"),n("3dw1"),n("U00V"),n("F9vW"),n("qwoB"),n("4SRy"),n("9DLp"),n("f5ON"),n("SeWL"),n("wcNg"),n("w//1"),n("jLTt");var r=n("hpu3");e.hot,window.Caissa=r.c,r.c.onafterImport(),t.cls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";for(var r in e)e[r]&&(n+="".concat(n&&t)+r);return n};var a=document.body.querySelector(".root");t.route.prefix="#!",t.route(a,r.a,r.b)}.call(this,n("Ono3")(e),n("mjLj"))},Qie3:function(e,t,n){"use strict";(function(e){var r=n("B1qE"),a=n("triP"),i=n("0iYD"),o=a.a.game;function s(e,t){return"w"===t.color?e.push([t]):e[e.length-1].push(t),e}function c(t,n){return e(r.a,{num:n+1,white:{move:t[0]},black:{move:t[1]||{piece:"",fen:"",flags:{},san:"",cp:0}}})}var u=i.a.create("Moves",{view:function(){return e("div.gm-moves.viewport-y.flex-shrink",[e("table.w-100.collapse",o.moves.reduce(s,[]).map(c))])}});t.a=u}).call(this,n("mjLj"))},SBU7:function(e,t,n){"use strict";(function(e){var r=n("hpu3"),a=n("triP"),i=n("qxKj"),o=n("Jnlq"),s=n("0iYD"),c=n("4Glx"),u=n("Dpii"),l=a.a.games,d=o.b.interprete,p="",f=s.a.create("Games",{oninit:function(e){var t=~~e.attrs.params.idx,n=i.a.list.find((function(e){return e.idx===t}));n.games.length||n.fetch().then((function(){n.progress=0}))},view:function(t){var n=t.attrs,a=n.className,o=n.style,s=":idx"===t.attrs.params.idx&&void 0===l.idx?void 0:":idx"===t.attrs.params.idx&&void 0!==l.idx?l.idx:~~t.attrs.params.idx,f=void 0!==s?i.a.list.find((function(e){return e.idx===s})):void 0;if(l.idx=s,void 0!==f||void 0!==s){if(f.games.length){var h=f.games.filter((function(e){return!p.length||e.searchtext.includes(p)}));return e("div.page.games",{className:a,style:o},[e(u.n,p.length?d(f.header):d(f.header)+"[".concat(h.length,"/").concat(f.games.length,"]")),e(u.i,{oninput:function(e){p=e.target.value.toLowerCase()}}),e(c.a,{games:h})])}return f.fetch().then((function(){f.progress=0})),e("div.page.games",{className:a,style:o},e(u.c,[e("img.source-icon",{src:f.icon}),e("div.source-caption.f4",f.caption),e("div.source-subline.f5.ellipsis",f.subline),f.games.length?e("div.source-loaded",f.games.length+" games loaded"):"",f.error?e("div.source-error.f5.mv1",f.error):"",f.progress?e("div.source-progress-on",{style:"width: ".concat(f.progress,"%;")}):e("div.source-progress-off")]))}r.c.route("/games/:idx/",{idx:0},{replace:!0})}});t.a=f}).call(this,n("mjLj"))},Sgp0:function(e,t,n){"use strict";var r,a,i,o,s,c=n("Mebt"),u=n("vdVe"),l=Math.abs,d=innerWidth/3,p={selektor:"",time:NaN,down:{x:NaN,y:NaN},diff:{x:NaN,y:NaN}},f=c.a.transitionEnd,h={listen:function(){c.a.touch&&(document.addEventListener("touchstart",h.down,!1),document.addEventListener("touchmove",h.move,!1),document.addEventListener("touchend",h.end,!1),console.log("touchSlider.listening"))},remove:function(){document.removeEventListener("touchstart",h.down,!1),document.removeEventListener("touchmove",h.move,!1),document.removeEventListener("touchend",h.end,!1),console.log("touchSlider.removed")},pause:function(){p.selektor=""},init:function(e,t,n,c,u,l){r=e,a=n,p.selektor=t,i=c,o=u,s=l,d=innerWidth/4,console.log("touchSlider.init",t,c,u),r&&console.log("left",r),a&&console.log("right",a)},down:function(e){p.selektor&&e.target.closest(p.selektor)&&(p.time=Date.now(),p.down.x=e.touches[0].clientX,p.down.y=e.touches[0].clientY,p.diff.x=0,p.diff.y=0)},onafterback:function(){r.removeEventListener(f,h.onafterback),u.a.goback()},onafterfore:function(){a.removeEventListener(f,h.onafterfore),u.a.gofore()},move:function(e){if(p.down.x||p.down.y){var t=e.touches[0].clientX,n=e.touches[0].clientY;p.diff.x=p.down.x-t,p.diff.y=p.down.y-n,r&&u.a.canBack&&p.diff.x<0&&(l(p.diff.x)>d?(r.addEventListener(f,h.onafterback),r.classList.add("slide-transition")):r.style.transform="translateX("+l(p.diff.x)+"px)"),a&&u.a.canFore&&p.diff.x>0&&(l(p.diff.x)>d?(a.addEventListener(f,h.onafterfore),a.classList.add("slide-transition")):a.style.transform="translateX("+(2*s-l(p.diff.x))+"px)")}},end:function(){p.selektor&&(p.down={x:NaN,y:NaN},p.diff={x:NaN,y:NaN},r&&(r.style.transform=i),a&&(a.style.transform=o),console.log("touchSlider.end",p.selektor))}};t.a=h},TqsC:function(e,t,n){"use strict";(function(e){var r=n("0iYD"),a=null,i=r.a.create("Last",{onregister:function(e){a=e},view:function(){return e("div.last.dn")},onupdate:function(e){var t=e.attrs.msecs;setTimeout((function(){return a.send("onafterupdates",{msecs:t})}),0)},oncreate:function(e){var t=e.attrs.msecs;setTimeout((function(){return a.send("onafterupdates",{msecs:t})}),0)}});t.a=i}).call(this,n("mjLj"))},"UN+b":function(e,t,n){"use strict";(function(e){var r=n("nxTg"),a=n.n(r),i=n("5WRv"),o=n.n(i),s=n("dU0s"),c=n("0iYD"),u=n("Wwkf"),l=n("Jnlq"),d=n("hpu3"),p=n("Ehzf"),f=c.a.create("Navigation",{view:function(t){var n=t.attrs.route,r=s.b[n].navi,i=function(e,t){return function(n){return n.redraw=!1,p.a.hide(),d.c.route(e,t),Object(l.a)("#toggle-mobile-menu").checked=!1,l.b.eat(n)}};return e("nav",[e("label",{for:"toggle-mobile-menu","aria-label":"Menu"},e("i.hamburger.fa.fa-bars "),e("span.home.f4.fiom.white.pl3","Caissa")),e("input[type=checkbox]",{id:"toggle-mobile-menu",oninput:function(e){e.redraw=!1,e.target.checked&&p.a.show((function(){Object(l.a)("#toggle-mobile-menu").checked=!1}))}}),e("ul",o()(u.a.navigation.map((function(t){var n=a()(t,3),o=n[0],s=n[1],c=n[2];return e("li",{onclick:i(o,s),class:o.startsWith(r)?"selected":"unselected"},c)}))))])}});t.a=f}).call(this,n("mjLj"))},UdF5:function(e,t,n){},Wwkf:function(e,t,n){"use strict";var r=n("OvAC"),a=n.n(r),i=n.p+"images/chessboard-sprite.029b07f9.svg",o=n("wOn7"),s=n("Jnlq");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var u=s.b.create({empty:"8/8/8/8/8/8/8/8 w - - 0 1",start:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}),l=s.b.create({fens:{white:"PPPPPPPPRNBQKBNR",black:"pppppppprnbqkbnr",sorted:"kqrbnp"},blacks:["wk","wq","wr","wb","wn","wp"],whites:["bk","bq","br","bb","bn","bp"]}),d=s.b.create({moves:[],fen:u.start,play:null,timecontrol:null}),p=s.b.create({uuid:"00000000",white:"White",black:"Black",event:"",site:"",round:"",date:"",result:"",termination:"",timecontrol:"",pgn:"",header:{}}),f=s.b.create(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},p,{mode:"h-h",turn:-3,plycount:0,subline:"this is fun",opening:"",time:10,depth:3,difficulty:"rooky",timestamp:1589137091395})),h=s.b.create({game:{},moves:[],score:{maxcp:0,maxmate:0},buttons:{minimize:!0,maximize:!1,rotate:!0,backward:!0,forward:!0,left:!0,right:!0,play:!1,pause:!1,evaluate:!0,spinner:!1},flags:{turn:"",over:!1,chck:!1,mate:!1,draw:!1,stal:!1,insu:!1,repe:!1}}),m=s.b.create({h:"Human",l:"Leela",s:"Stockfish"});t.a=s.b.deepFreeze(s.b.create({fens:u,pieces:l,opponents:m,gametemplate:f,gametemplateshort:p,gamestatetemplate:h,playstatetemplate:d,playtemplates:[{mode:"s-s",turn:0,uuid:"0000000A",subline:"this is fun",pgn:"",white:"Stockfish",black:"Stockfish",engine:"stockfish"},{mode:"h-s",turn:0,uuid:"0000000B",subline:"beat the machine",pgn:"",white:"Human",black:"Stockfish",engine:"stockfish"}],pagecache:{size:5},navigation:[["/sources/",{},"PGNS"],["/games/",{},"GAMES"],["/game/",{},"GAME"],["/plays/",{},"PLAY"],["/analyzer/",{},"ANALYSE"],["/system/:module/",{module:"system"},"SYSTEM"],["/options/",{},"OPTIONS"],["/help/",{},"HELP"]],apis:[{idx:1,caption:"api.chess.com/pub/player/",value:"https://api.chess.com/pub/player/noiv/games/2020/04/pgn"},{idx:2,caption:"lichess.org/api/games/user",value:"http://localhost:3000/static/games.pgn"},{idx:3,caption:"localhost:3000/static/games.few.pgn",value:"http://localhost:3000/static/games.few.pgn"},{idx:4,caption:"localhost:3000/static/games.pgn",value:"http://localhost:3000/static/games.pgn"}],openings:[s.b.create({idx:0,caption:"OP01",value:"OP01"}),s.b.create({idx:1,caption:"OP02",value:"OP02"}),s.b.create({idx:2,caption:"OP03",value:"OP03"})],timecontrols:[s.b.create({idx:0,caption:"10 secs",value:"".concat(1e4,"|0")}),s.b.create({idx:1,caption:"1 min",value:"".concat(6e4,"|0")}),s.b.create({idx:2,caption:"5 min",value:"".concat(3e5,"|0")}),s.b.create({idx:3,caption:"10 min",value:"".concat(6e5,"|0")})],plays:s.b.create({difficulties:{0:"looser",3:"rooky",5:"beginner",10:"experienced",20:"hardcore",30:"no chance"},defaults:[{uuid:"00000001",mode:"h-s",time:10,depth:3,subline:"play white against Stockfish"},{uuid:"00000002",mode:"s-h",time:10,depth:3,subline:"play black against Stockfish"},{uuid:"00000003",mode:"s-s",time:10,depth:3,subline:"this is fun"}]}),board:s.b.create({config:{position:"empty",orientation:o.a.white,style:{cssClass:"gray",showCoordinates:!1,showBorder:!1},sprite:{url:i,grid:40,markers:["marker4","marker5"]},responsive:!0,animationDuration:300,moveInputMode:o.e.dragPiece}}),flagTitles:s.b.create({n:"a non-capture",b:"a pawn push of two squares",e:"an en passant capture",c:"a standard capture",p:"a promotion",k:"kingside castling",q:"queenside castling",pc:"capture + promotion"}),flagColors:s.b.create({w:{n:"#fff",b:"darkgreen",e:"darkgreen",c:"darkred",p:"red",k:"darkgreen",q:"darkgreen",pc:"orange"},b:{n:"#333",b:"darkgreen",e:"darkred",c:"darkred",p:"red",k:"darkgreen",q:"darkgreen",pc:"orange"}}),fontPieces:s.b.create({k:"l",q:"w",r:"t",b:"n",n:"j",p:"o"}),fontPiecesWhite:s.b.create({K:"l",Q:"w",R:"t",B:"n",N:"j",P:"o"})}))},XasM:function(e,t,n){"use strict";var r=n("aHqP"),a=n.n(r),i=n("vVKl"),o=a()(),s=0;function c(e){return JSON.stringify(e).replace(/"/g,"").slice(0,140)}t.a={connect:function(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=e.name,l=[];return o.map((function(o){if(!l.find((function(e){return e.id===o.id}))&&o.source!==u&&(o.targets.includes("*")||o.targets.includes(u))&&"function"==typeof e[o.action]){for(e[o.action].apply(null,o.params);l.length>=5;)l.shift();l.push(o),t=o.source,n=o.targets.join(";"),r=c(o.params),a&&i.a.log("dispatcher","".concat(t," -g> ").concat(n,".").concat(o.action," ").concat(r))}})),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["*"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],d={id:s+=1,source:u,targets:e="string"==typeof e?[e]:e,action:r,params:l="number"==typeof(l="string"==typeof l?[l]:l)?[l]:l};t=d.source,n=d.targets.join(";"),l=c(d.params),a&&i.a.log("dispatcher","".concat(t," -r> ").concat(n,".").concat(d.action," ").concat(l)),o(d)}}}},ZIMq:function(e,t,n){"use strict";(function(e){var r,a,i,o,s,c=n("nxTg"),u=n.n(c),l=n("hpu3"),d=n("Jnlq"),p=n("vdVe"),f=n("0iYD"),h=n("dU0s"),m=n("Mebt"),v=n("Sgp0"),g=m.a.transitionEnd,b=f.a.create("Pages",{oninit:function(){v.a.listen()},onbeforeupdate:function(){v.a.pause()},onremove:function(){v.a.remove()},onresize:function(e,t){e<=360?(s=e,a="translateX(    0)",i="translateX( 100vw )",o="translateX( calc(2*100vw) )"):(s=360,a="translateX(    0)",i="translateX( 360px )",o="translateX( 720px )"),console.log("pages.onresize",e,t)},view:function(){var t=p.a.slides(),n=u()(t,1)[0],s=u()(n,4),c=s[0],l=s[1],f=s[2],m=s[3];return p.a.log(),console.log("PAGES.view",n.slice(0,3).map((function(e){return e.content.name})),m),r=m,e("div.pages",{},h.a.map((function(t){var n=c.content===t,r=l.content===t,s=f.content===t,u=Object(d.a)("div.page."+t.name.toLowerCase());return n||r||s?(t.preventUpdates=!1,u&&(u.classList.remove("dn"),n&&(u.classList.add("slide","left"),u.setAttribute("style","z-index: 12; transform: "+a+";")),r&&(u.classList.add("slide","center"),u.setAttribute("style","z-index: 11; transform: "+i+";")),s&&(u.classList.add("slide","right"),u.setAttribute("style","z-index: 12; transform: "+o+";")))):(t.preventUpdates=!0,u&&(u.classList.remove("slide","left","center","right"),u.classList.add("dn"),u.removeAttribute("style"))),n?e(c.content,{route:c.route,params:c.params,className:"slide left",style:"z-index: 12; transform: "+a}):r?e(l.content,{route:l.route,params:l.params,className:"slide center",style:"z-index: 11; transform: "+i}):s?e(f.content,{route:f.route,params:f.params,className:"slide right",style:"z-index: 12; transform: "+o}):e(t,{route:"",params:{},className:"dn"})})))},onafterupdates:function(){var e=Object(d.a)("div.slide.left"),t=(Object(d.a)("div.slide.center"),Object(d.a)("div.slide.right"));"=1="===r||"=r="===r||"=s="===r||"=w="===r?(e&&(e.style.transform=a),t&&(t.style.transform=o),(p.a.canBack||p.a.canFore)&&setTimeout((function(){v.a.init(Object(d.a)("div.slide.left"),"div.slide.center",Object(d.a)("div.slide.right"),a,o,s)}),0)):"=b="===r||"=f="===r?l.c.redraw():"=b>"===r?(t&&(t.style.zIndex=10),e&&(e.style.zIndex=12,e.addEventListener(g,w),e.classList.add("slide-transition"))):"<c="===r||"<f="===r?(e&&(e.style.zIndex=10),t&&(t&&(t.style.zIndex=12),t.addEventListener(g,w),t.classList.add("slide-transition"))):console.warn("pages.onafterupdates.unknown anim",r)}});function w(){console.log("%cpages.onafteranimate.in %s",{color:"green"},r);var e=Object(d.a)("div.slide.left"),t=Object(d.a)("div.slide.right");"=1="===r||"=r="===r||"=s="===r||"=w="===r?(e.style.transform=a,t.style.transform=o):"<c="===r||"<f="===r?(e&&(e.style.transform=a),t.removeEventListener(g,w),t.classList.remove("slide-transition"),t.style.transform=i):"=b>"===r&&(t&&(t.style.transform=o),e.removeEventListener(g,w),e.classList.remove("slide-transition"),e.style.transform=i),r="",l.c.redraw(),(p.a.canBack||p.a.canFore)&&setTimeout((function(){v.a.init(Object(d.a)("div.slide.left"),"div.slide.center",Object(d.a)("div.slide.right"),a,o)}),0)}t.a=b}).call(this,n("mjLj"))},bdsc:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("hpu3"),a=n("QH1x"),i=n("Jnlq"),o=n("Mebt"),s=n("07Fe"),c=n("BwVn");function u(e){var t=Date.now(),n=(99-12*d)/e.moves.length,u=a.a.Options["game-evaluator"],l=~~u.maxdepth,d=~~u.maxthreads,p=i.b.partitions(e.moves,d),f=0,h=0;e.score.maxcp=0,e.score.maxmate=0,e.buttons.evaluate=!1,e.buttons.spinner=!0;var m={depth:l,time:u.maxsecs},v=function(e){h+=e,c.c.render(h)},g=function(t){f+=1,v(n),e.score.maxcp=Math.abs(t.cp)>e.score.maxcp?t.cp:e.score.maxcp,2%f||r.c.redraw()};console.log("game.evaluator.start",d,"/",o.a.threads,"depth",m.depth),c.c.render(4),Promise.all(s.a.request(d).map((function(e,t){return v(4),e.engine.init().then((function(e){return v(4),e.evaluateMoves(p[t],m,g)})).then((function(e){return v(4),e.slot}))}))).then((function(n){e.buttons.evaluate=!0,e.buttons.spinner=!1,n.forEach((function(e){return e.idle=!0})),c.c.render(0),r.c.redraw(),console.log("game.evaluator.finish",e.moves.length,"moves in",Date.now()-t,"msecs","".concat(d,"/").concat(o.a.threads," threads"),"depth:",m.depth,n)}))}},c7Ff:function(e,t,n){},dU0s:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return m}));var r=n("u6GA"),a=n("9pvG"),i=n("n8lb"),o=n("SBU7"),s=n("kbMm"),c=n("/MfA"),u=n("lJ9B"),l=n("9ubP"),d=n("JSL1"),p=n("nkYS"),f=n("Dpii"),h=n("Jnlq"),m=[d.a,o.a,l.a,i.a,p.a,s.a,c.a],v=h.b.create({"/sources/":[r.a,d.a,u.a,{navi:"/sources/",flags:" sb ",title:"Sources"}],"/games/":[r.a,o.a,u.a,{navi:"/games/",flags:" sb ",title:"Games"}],"/games/:idx/":[r.a,o.a,u.a,{navi:"/games/",flags:" sb ",title:"Games %s"}],"/game/":[r.a,l.a,u.a,{navi:"/game/",flags:" sb ",title:"Games"}],"/game/:turn/:uuid/":[r.a,l.a,u.a,{navi:"/game/",flags:" sb ",title:"Game %s"}],"/plays/":[r.a,s.a,u.a,{navi:"/plays/",flags:" sb ",title:"Plays"}],"/plays/:mode/":[r.a,s.a,u.a,{navi:"/plays/",flags:" sb ",title:"Plays"}],"/play/:uuid/":[r.a,c.a,u.a,{navi:"/play/",flags:" sb ",title:"Plays %s"}],"/analyzer/:fen/":[r.a,l.a,u.a,{navi:"/analyzer/",flags:" sb ",title:"Analyzer"}],"/options/":[r.a,i.a,u.a,{navi:"/options/",flags:" sb ",title:"Options"}],"/system/":[r.a,p.a,f.j,{navi:"/system/",flags:" sb ",title:"System"}],"/system/:module/":[r.a,p.a,f.j,{navi:"/system/",flags:" sb ",title:"System %s"}],"/help/":[r.a,a.a,f.j,{navi:"/help/",flags:" fw ",title:"Help"}],"/help/:url/":[r.a,a.a,f.j,{navi:"/help/",flags:" fw ",title:"Help"}]})},gPPA:function(e,t,n){"use strict";(function(e){var r=n("0iYD").a.create("Main",{view:function(t){return e("main",{},t.children)}});t.a=r}).call(this,n("mjLj"))},hpu3:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return w}));var r=n("nxTg"),a=n.n(r),i=n("OvAC"),o=n.n(i),s=n("Jnlq"),c=n("vdVe"),u=n("dU0s"),l=n("QH1x"),d=n("CNX3"),p=n("0iYD"),f=n("triP"),h=n("Mebt");function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=50,b={H:s.b,DB:l.a,State:f.a,System:h.a,onafterImport:function(){d.a.listen()},start:function(){document.body.removeChild(Object(s.a)("loading-screen")),document.body.removeChild(Object(s.a)("loading-backdrop"))},onregister:function(e){setTimeout((function(){Object(s.a)("loading-screen .messages").innerHTML+="<br>"+e}),g+=50)},onload:function(){var e=Date.now()-window.t0;e>2e3?console.warn("Warn   :","... done after",0,e,"msecs"):console.log("Info   :","... done after",0,e,"msecs"),l.a.Options.ui.waitscreen?(Object(s.a)("loading-screen button.start").style.display="inline-block",Object(s.a)("loading-screen button.reload").style.display="inline-block",Object(s.a)("loading-screen button.a2home").style.display="inline-block",Object(s.a)("loading-screen .option-waitscreen").style.display="inline-block"):(document.body.removeChild(Object(s.a)("loading-screen")),document.body.removeChild(Object(s.a)("loading-backdrop"))),console.log(" ")},redraw:function(){console.log(" "),c.a.prepare("",{},{redraw:!0}),e.redraw()},route:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1};console.log(" "),console.log("%cCaissa.route.in %s %s %s","color:darkred; font-weight: 800",t,s.b.shrink(n),s.b.shrink(r));var a=u.b[t];a?(c.a.prepare(t,n,r),e.route.set(t,n,v({title:a.title},r))):console.warn("caissa.route.error",t,n,r)},resolver:function(t,n){return{onmatch:function(n){try{var r=e.buildPathname(t,n),a=c.a.isCurrent(r)?"current":"new";console.log("%cCaissa.onmatch.in %s %s ","color:darkblue; font-weight: 800",r,a),c.a.prepare(t,n)}catch(e){console.log(JSON.stringify(e),e)}},render:function(r){var a=n[1],i=e.buildPathname(t,r.attrs),o=c.a.isCurrent(i)?"current":"new";return console.log("%cCaissa.render.in %s %s","color:darkorange; font-weight: 800",i,o),c.a.finalize(t,r.attrs,a),e(b.comp,{route:t,params:r.attrs})}}},comp:p.a.create("Caissa",{view:function(t){var n=t.attrs,r=n.route,i=n.params,o=a()(u.b[r],4),s=o[0],l=o[1],d=o[2],p=o[3],f=e.buildPathname(r,i);return console.log("%cCaissa.view.in %s %s","color:darkgreen; font-weight: 800",f,c.a.animation),document.title=p.title,e(s,{route:r,params:i},[l,d])}})},w="/sources/",y=s.b.transform(u.b,b.resolver)}).call(this,n("mjLj"))},j26v:function(e,t,n){},jLTt:function(e,t,n){},kbMm:function(e,t,n){"use strict";(function(e){var r=n("OvAC"),a=n.n(r),i=n("hpu3"),o=n("QH1x"),s=n("97EL"),c=n("MqTa"),u=n("Wwkf"),l=n("0iYD"),d=n("Dpii");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var f={};u.a.playtemplates.forEach((function(e){var t="play-"+e.mode,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({group:t,autosubmit:!1},o.a.Options[t],{submit:function(t){var n=c.a.createPlayTemplate(e,t);o.a.Plays.create(n),console.log("plays.form.submitted",n.uuid,n.mode,n.white,n.black),i.c.route("/play/:uuid/",{uuid:n.uuid})}});f[e.mode]=n}));var h=l.a.create("Plays",{view:function(t){var n=t.attrs,r=n.className,a=n.style,c=t.attrs.params.mode;return e("div.page.plays",{className:r,style:a},[e(d.n,"Start a new Play"),e(d.a,u.a.playtemplates.map((function(t){var n=f[t.mode],r=c===t.mode?{marginBottom:"0px",backgroundColor:"rgba(255,255,255,.2)"}:{},a=c===t.mode?function(e){e.redraw=!1,i.c.route("/plays/",{},{replace:!0})}:function(e){e.redraw=!1,i.c.route("/plays/:mode/",{mode:t.mode},{replace:!0})};return e("[",[e(d.c,{onclick:a,style:r},[e("div.fiom.f4",t.white+" vs. "+t.black),e("div.fior.f5",t.subline)]),t.mode===c?e(s.a,{formdata:n,class:"play-options",style:"background-color: rgba(255,255,255,.3)"}):e(d.j)])}))),e(d.n,"Resume a Play ("+o.a.Games.list.length+")"),e(d.e,o.a.Plays.list.map((function(t){return e(d.d,{onclick:function(e){e.redraw=!1,i.c.route("/play/:uuid/",{uuid:t.uuid})},play:t})}))),e(d.k),e("button.pv1.mh3.mv1",{onclick:function(){return o.a.Plays.clear()}},"DB.Plays.clear()"),e("button.pv1.mh3.mv1",{onclick:function(){return o.a.reset()}},"DB.reset()")])}});t.a=h}).call(this,n("mjLj"))},lJ9B:function(e,t,n){"use strict";(function(e){var r=n("uoUx"),a=n.n(r),i=n("wOn7"),o=n("Jnlq"),s=n("triP"),c=n("Wwkf"),u=n("XasM"),l=n("MqTa"),d=n("JEw6"),p=s.a.board,f=new a.a,h=null,m={name:"board",fen:function(e){h&&h.setPosition(e,!0)},game:function(e){if(-2===e.game.turn)p.fen=c.a.fens.empty;else if(-1===e.game.turn)p.fen=c.a.fens.start;else{var t=e.game.turn,n=e.moves[t];n||console.log("board.game.no.move",e.game.uuid,t,n,e.moves.length),p.fen=n.fen}p.white=e.game.white,p.black=e.game.black,!f.load(p.fen)&&console.warn("board.fen.failed",p.fen),l.a.updateFlags(f)},piece:function(e,t,n){if("add"===e){var r=t[1],a=t[0];f.put({type:r,color:a},n),h.setPosition(f.fen(),!0)}else console.log("WTF")},mark:function(e){var t=p.illustrations;void 0!==t.marker[e]&&(t.marker[e]=!t.marker[e]),void 0!==t.arrows[e]&&(t.arrows[e]=!t.arrows[e]),l.a.updateMarker(f,h,p),l.a.updateArrows(f,h,p)}};u.a.connect(m,!1),t.a={name:"Board",onremove:function(){h.destroy()},onbeforeupdate:function(){return!1},onupdate:function(e){h?(h.setOrientation(p.orientation),h.enableMoveInput(Object(d.a)({move:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,["board.onupdate.move"].concat(n))}},f),i.a.white),h.setPosition(p.fen,!0),console.log("board.onupdate",o.b.strip(e.attrs))):console.log("board.onupdate","NO BOARD")},oncreate:function(){h=new i.b(document.querySelector("div.chessboard"),c.a.board.config)},view:function(){return e("div.chessboard.dropzoneXX")}}}).call(this,n("mjLj"))},n8lb:function(e,t,n){"use strict";(function(e){var r=n("OvAC"),a=n.n(r),i=n("5WRv"),o=n.n(i),s=(n("c7Ff"),n("QH1x")),c=n("97EL"),u=n("0iYD"),l=n("Dpii");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var p=Object.keys(s.a.Options),f=u.a.create("Options",{oncreate:function(){p=Object.keys(s.a.Options)},view:function(t){var n=t.attrs,r=n.className,i=n.style;return e("div.page.options",{className:r,style:i},[e(l.n,"Options"),e("div.mv1.ph3.w-100",e("button.w-100.pv1",{onclick:function(){return s.a.reset()}},"Defaults"))].concat(o()(p.map((function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({group:t,autosubmit:!0},s.a.Options[t],{submit:function(){s.a.Forms.save(t,n)}});return e(c.a,{formdata:n,class:"default-options group-"+t})})))))}});t.a=f}).call(this,n("mjLj"))},nkYS:function(e,t,n){"use strict";(function(e){n("ujPc");var r=n("hpu3"),a=n("Mebt"),i=n("Wwkf"),o=n("triP"),s=n("QH1x"),c=n("0iYD"),u=n("4VUy"),l=n("0MiI"),d={name:"Json",view:function(t){var n=t.attrs.tree;return e("div.w-100.viewport-y.h-100",[e("div.f5.fior",{class:"json-tree"},[e(l.a,{tree:n,options:{collapseAfter:1}})])])}},p=c.a.create("System",{view:function(t){var n=t.attrs,c=n.params.module,l=n.className,p=n.style,f="config"===c?e(d,{tree:i.a}):"system"===c?e(d,{tree:a.a}):"state"===c?e(d,{tree:o.a}):"db"===c?e(d,{tree:s.a.all()}):e(u.a),h=function(e){return function(t){t.redraw=!1,r.c.route("/system/:module/",{module:e},{replace:!0})}};return e("div.page.system",{className:l,style:p},[e("div.systemmenu.w-100.btb20",[e("ul.flex.flex-row.ml2","System Config State DB Logs".split(" ").map((function(t){return e("li.ph2.pv1.f4.list.pointer",{onclick:h(t.toLowerCase())},t)})))]),f])}});t.a=p}).call(this,n("mjLj"))},ohXN:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w}));var r,a,i,o,s,c,u,l,d,p,f,h,m,v,g=n("Jnlq"),b=n("0iYD"),w=(h={format:g.b.msec2HMS,time:0,color:"cred"},m={},v={},{start:function(e){a="w",s=e,u=0,c=0,l=5,i=Date.now(),Object.assign(m,h),Object.assign(v,h),o&&clearInterval(o),o=setInterval(w.tick,100),r=!0},stop:function(){clearInterval(o),r=!1},render:function(){e.render(p,w.white),e.render(d,w.black),e.render(f,w.total)},tick:function(){u+=1,c=Date.now()-i,m.time="w"===a?c-v.time:m.time,v.time="b"===a?c-m.time:v.time,s-m.time<1e4&&(m.format=g.b.msec2HMSm,m.color="darkred",l=1),s-v.time<1e4&&(v.format=g.b.msec2HMSm,v.color="darkred",l=1),(m.time>=s||v.time>=s)&&(m.time=m.time>s?s:m.time,v.time=v.time>s?s:v.time,w.render(),clearInterval(o),w.over&&w.over(m.time,v.time)),u%l||(w.ontick&&w.ontick(),w.render())},blackclick:function(){"b"===a&&(a="w")},whiteclick:function(){"w"===a&&(a="b")},get white(){return m.format(s-m.time)},get black(){return v.format(s-v.time)},get total(){return g.b.msec2HMSm(c)},comp:function(){return b.a.create({name:"Chessclock",oncreate:function(e){var t=e.attrs.player;"w"===t&&(p=e.dom),"b"===t&&(d=e.dom),"*"===t&&(f=e.dom)},view:function(t){var n=t.attrs.player,a="div.fiom.f4.",i=a+(r?m.color:"c999"),o=a+(r?v.color:"cddd");return"w"===n?e(i,r?w.white:"0:00:00"):"b"===n?e(o,r?w.black:"0:00:00"):e("div.fiom.f4.orange",w.total)}})}})}).call(this,n("mjLj"))},okTh:function(e,t,n){"use strict";(function(e){var r=n("0iYD"),a=n("Dpii"),i=r.a.create("Sections",{view:function(){return e("section",{},e(a.j))}});t.a=i}).call(this,n("mjLj"))},pP2Y:function(e,t,n){"use strict";(function(e){n("8B4M");var r=n("T64k"),a=n.n(r),i=n("Mebt"),o=n("vdVe"),s=n("0iYD"),c=n("UN+b"),u=s.a.create("Header",{view:function(t){var n=t.attrs,r=n.route,s=n.params;return e("header",[e(c.a,{route:r,params:s}),o.a.canBack?e("i.navi.fa.fa-angle-left",{onclick:o.a.onback}):e("i.navi.fa.fa-angle-left.ctrans"),o.a.canFore?e("i.navi.fa.fa-angle-right",{onclick:o.a.onfore}):e("i.navi.fa.fa-angle-right.ctrans"),e("i.navi.fa.fa-retweet",{onclick:function(e){e.redraw=!1,window.location.reload()}}),e("i.navi.fa.fa-expand-arrows-alt",{onclick:function(e){e.redraw=!1,i.a.fullscreen&&a.a.toggle()}})])}});t.a=u}).call(this,n("mjLj"))},qxKj:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n("xd8G"),a=n("+O/N"),i=n("UBKX"),o=n("zaI2"),s=n("QH1x"),c=n("OvAC"),u=n.n(c),l=n("Wwkf"),d=n("MqTa");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={readGames:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\n",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Date.now();e=e.replace(/\r/g,"").replace(/\t/g," "),n&&(e=e.replace(/\s?\{[^}]+\}/g,""));var r,a=[],i=e.split(t),o=f({},l.a.gametemplateshort,{header:{}});return i.forEach((function(e){e=e.trim(),null!==(r=e.match(/^\[(\w+)\s+"(.*)"\]$/))&&"Event"===r[1]?(o.header.Event&&a.push(o),(o=f({},l.a.gametemplateshort,{header:{}})).header[r[1]]=r[2]):null!==r?""!==r[2]&&(o.header[r[1]]=r[2]):e.length&&(o.pgn+=" "+e)})),o.header.Event&&a.push(o),a},sanitizeGames:function(e){return e.map((function(e){return e.uuid=d.a.genGameHash(e),e.white=e.header.White?e.header.White:"White",e.black=e.header.Black?e.header.Black:"Black",e.header.Result&&(e.result=e.header.Result),e.header.Round&&(e.round=e.header.Round),e.header.Site&&(e.site=e.header.Site),e.date=e.header.Date?e.header.Date:e.header.EventDate?e.header.EventDate:e.header.UTCDate?e.header.UTCDate:"????.??.??",e.header.Time&&(e.time=e.header.Time),e.header.Termination&&(e.termination=e.header.Termination),e.header.TimeControl&&(e.timecontrol=e.header.TimeControl),e.header.Eco&&(e.eco=e.header.Eco),e.header.PlyCount&&(e.plycount=~~e.header.PlyCount),e.searchtext=(e.date+" "+(e.result||"")+" "+e.white+" "+e.black+" "+(e.event||"")).toLowerCase(),e.pgn,e}))}};function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e){var t=v({},e,{error:"",progress:0,games:[],header:function(){return"".concat(t.caption," ").concat(t.games.length," Games")},fetch:function(){return t.progress=10,new Promise((function(n){t.games=h.readGames(e.source),t.progress=60,t.games=h.sanitizeGames(t.games),t.progress=0,n()}))}});return t},b=function(e){var t=v({},e,{error:"",progress:0,games:[],header:function(){return"".concat(t.games.length," downloaded Games")},fetch:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return t.progress=10,fetch(t.source).then((function(e){if(!e.ok)throw e.status+" - "+e.statusText;return t.progress=30,e.text()})).then((function(e){return t.progress=50,h.readGames(e)})).then((function(e){t.progress=70,t.games=h.sanitizeGames(e)})).then((function(){t.progress=0})).catch((function(e){t.progress=0,t.error=String(e)}))}))});return t},w=[{idx:0,key:"pgnimport00",caption:"Famous Chess Games",subline:"Collection included with Caissa, [21]",icon:o.a,source:r.a,constructor:g},{idx:1,key:"pgnimport01",caption:"Capablanca's Best Games",subline:"JosÃ© RaÃºl Capablanca, 1888 â€“ 1942, [11]",icon:o.a,source:a.a,constructor:g},{idx:2,key:"pgnurl00",caption:"Alekhine's Best Games",subline:"Alexander Alekhine, 1882 â€“ 1946, [10]",icon:i.a,source:"/static/pgn/alekhine-best-games.pgn",info:"https://en.wikipedia.org/wiki/Alexander_Alekhine",constructor:b},{idx:3,key:"pgnurl01",caption:"FIDE Steinitz Memorial 2020",subtext:"The FIDE Online Steinitz Memorial took place 15th to 17th May 2020. Two 10 player events an Open and a Women's event - 18 Round Double Round Robin over 3 days. ",icon:i.a,source:"/static/pgn/steinitzmem20.pgn",info:"https://theweekinchess.com/chessnews/events/fide-online-steinitz-memorial-2020",constructor:b}];function y(e){var t={user:s.a.Options["user-data"].name,month:("00"+((new Date).getUTCMonth()+1)).slice(-2),year:(new Date).getUTCFullYear()};return e.map((function(e){return e.constructor(e,t)}))}var k={load:function(){return k.list=y(w)},list:[]};k.list=y(w)},shM7:function(e,t,n){},triP:function(e,t,n){"use strict";var r=n("OvAC"),a=n.n(r),i=n("wOn7"),o=n("Jnlq"),s=n("Wwkf");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=o.b.create({game:o.b.create(u({},o.b.deepcopy(s.a.gamestatetemplate))),play:o.b.create(u({},o.b.deepcopy(s.a.playstatetemplate))),games:o.b.create({idx:0}),board:o.b.create({fen:"",pgn:"",orientation:i.a.white,moveStart:"",bestmove:{move:{from:"",to:""},ponder:{from:"",to:""}},illustrations:s.a.board.illustrations})})},u6GA:function(e,t,n){"use strict";(function(e){var r=n("nxTg"),a=n.n(r),i=(n("shM7"),n("pP2Y")),o=n("Ehzf"),s=n("gPPA"),c=n("TqsC"),u=n("0iYD"),l=n("ZIMq"),d=n("okTh"),p=u.a.create("Layout",{view:function(t){var n=t.attrs,r=n.route,u=n.params,p=a()(t.children,2),f=p[0],h=p[1];return e("div.layout",[e(o.a),e(i.a,{route:r,params:u}),e(s.a,[e(l.a,{route:r,params:u},f),e(d.a,{route:r,params:u},h)]),e(c.a,{msecs:Date.now()})])}});t.a=p}).call(this,n("mjLj"))},ujPc:function(e,t,n){},vVKl:function(e,t,n){"use strict";var r={engine:"ENGI",stockfish:"FISH",analyzer:"ANLY",logger:"LOGG",dispatcher:"DISP",games:"GAMS",evalgame:"NEWG"},a=0,i=[];function o(e,t){i.unshift(("00000"+a).slice(-5)+" "+(r[e]||"----")+" - "+function(e){return e.replace(/infinite/g,'<strong class="dark-blue">infinite</strong>').replace(/readyok/g,'<strong class="dark-green">readyok</strong>').replace(/uciok/g,'<strong class="dark-green">uciok</strong>').replace(/bestmove/g,'<strong class="dark-blue">bestmove</strong>').replace(/ponder/g,'<strong class="dark-blue">ponder</strong>').replace(/-r>/g,'<strong class="dark-red">==></strong>').replace(/-g>/g,'<strong class="dark-green">==></strong>')}(t)),a+=1}o("logger","init: "+(new Date).toLocaleTimeString()),t.a={log:o,shrink:function(e){return JSON.stringify(e).replace(/"/g,"").slice(0,140)},search:function(e){return e.length>2?i.filter((function(t){return t.includes(e)})):i}}},vdVe:function(e,t,n){"use strict";(function(e){var r=n("OvAC"),a=n.n(r),i=n("Jnlq"),o=n("Dpii"),s=n("hpu3");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={},d=[],p=NaN,f={back:!1,fore:!1,same:!1,replace:!1,redraw:!1,popstate:!1,hashchange:!1,noanimation:!1},h={stack:d,get pointer(){return p},log:function(){d.forEach((function(e,t){t===p?console.log("HIST."+t,[e.key,e.content.name,i.b.shrink(e.params)]):console.log("hist."+t,[e.key,e.content.name,i.b.shrink(e.params)])}))},isCurrent:function(e){return!(!d[p]||d[p].key!==e)},get current(){return d.length?d[p].key:""},get canBack(){return!isNaN(h.pointer)&&h.pointer>0},get canFore(){return!isNaN(h.pointer)&&h.pointer<h.stack.length-1},goback:function(){var e=d[p-1],t=e.route,n=e.params;s.c.route(t,n,{back:!0,noanimation:!0})},gofore:function(){var e=d[p+1],t=e.route,n=e.params;s.c.route(t,n,{fore:!0,noanimation:!0})},onback:function(e){e.redraw=!1;var t=d[p-1],n=t.route,r=t.params;return s.c.route(n,r,{back:!0}),i.b.eat(e)},onfore:function(e){e.redraw=!1;var t=d[p+1],n=t.route,r=t.params;return s.c.route(n,r,{fore:!0}),i.b.eat(e)},onhashchange:function(e){return f.hashchange=!0,i.b.eat(e)},onpopstate:function(e){return f.popstate=!0,i.b.eat(e)},recent:function(e){return d.map((function(e){return e.content})).slice(-e)},prepare:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{replace:!1},a=e.buildPathname(t,n);if(isNaN(p))console.log("history.check.pointer NaN","OK"),l[a]=u({},r);else if(l[a])console.log("history.prepare.ignored.exists",a);else if(d[p]&&d[p].key===a)f.same=!0,console.log("history.prepare.ignored.same",a);else if(r.redraw)f.redraw=!0,console.log("history.prepare.redraw",a);else if(r.replace||f.replace)l[a]=u({},r),f.replace=!0,console.log("history.prepare.replace",a,"=>",d[p].key),i.b.shrink(r);else if(r.back||f.back)f.back=!0,void 0!==r.noanimation&&(f.noanimation=!!r.noanimation),console.log("history.prepare.back",a,i.b.shrink(r));else if(r.fore||f.fore)f.fore=!0,void 0!==r.noanimation&&(f.noanimation=!!r.noanimation),console.log("history.prepare.fore",a,i.b.shrink(r));else if(f.hashchange||f.popstate)if(f.hashchange&&d[p-1]&&d[p-1].key===a)f.back=!0,console.log("history.prepare.urlChangeDetected.back",a);else if(f.hashchange&&d[p+1]&&d[p+1].key===a)f.fore=!0,console.log("history.prepare.urlChangeDetected.fore",a);else if(!f.hashchange&&f.popstate)f.same=!0,console.log("history.prepare.urlChangeDetected.same",a);else{for(l[a]=u({},r);d.length;)d.pop();console.log("history.prepare.urlChangeDetected.clear",a)}else l[a]=u({},r),console.log("history.prepare.done",a,i.b.shrink(r))},finalize:function(t,n,r){var a=e.buildPathname(t,n);if(f.replace&&l[a])d[p].key=a,d[p].params=n,delete l[a],console.log("history.finalize.replace.done",a,"==",d[p].key);else if(f.redraw)console.log("history.finalize.redraw.done",d[p]);else if(f.same||d[p]&&d[p].key===a)f.same=!0,console.log("history.finalize.same.done",d[p]);else if(f.back)p-=1,console.log("history.finalize.back.done",d[p]);else if(f.fore)p+=1,console.log("history.finalize.fore.done",d[p]);else if(l[a]){for(;p<d.length-1;){var o=d.pop();console.log("history.finalize.next.popped",p,d.length,o)}p=d.push(i.b.create({key:a,route:t,params:n,content:r}))-1,delete l[a],console.log("history.finalize.next.done",a,d[p])}else console.log("history.finalize.nocandidate.ignored",a)},get animation(){return 1===d.length?"=1=":f.replace?"=r=":f.redraw?"=w=":f.same?"=s=":f.back&&f.noanimation?"=b=":f.back&&!f.noanimation?"=b>":f.fore&&f.noanimation?"=f=":f.fore&&!f.noanimation?"<f=":"<c="},slides:function(){var e,t,n,r=i.b.create({content:o.j,route:"",params:i.b.create()});function a(e,t){return[0,1,2].map((function(t){return(d[p+e+t]||r).content.name})).concat([t,i.b.shrink(l)])}function s(e,t){return[0,1,2].map((function(t){return d[p+e+t]||r})).concat([t,i.b.shrink(l)])}if(1===d.length)e=a(-1,"=1="),t=s(-1,"=1=");else if(f.replace)e=a(n=-1,"=r="),t=s(n,"=r=");else if(f.redraw)e=a(n=-1,"=w="),t=s(n,"=w=");else if(f.same)e=a(n=-1,"=s="),t=s(n,"=s=");else if(f.back){var c=f.noanimation?"=b=":"=b>";e=a(0,c),t=s(0,c)}else if(f.fore){var u=f.noanimation?"=f=":"<f=";e=a(-2,u),t=s(-2,u)}else e=a(-2,"<c="),t=s(-2,"<c=");return i.b.clear(l),f.replace=!1,f.back=!1,f.fore=!1,f.same=!1,f.redraw=!1,f.popstate=!1,f.hashchange=!1,f.noanimation=!1,[t,e]}};t.a=h}).call(this,n("mjLj"))},wOn7:function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"e",(function(){return O})),n.d(t,"c",(function(){return P})),n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return D}));var r=n("SDJZ"),a=n.n(r),i=n("NToG"),o=n.n(i),s=["a1","b1","c1","d1","e1","f1","g1","h1","a2","b2","c2","d2","e2","f2","g2","h2","a3","b3","c3","d3","e3","f3","g3","h3","a4","b4","c4","d4","e4","f4","g4","h4","a5","b5","c5","d5","e5","f5","g5","h5","a6","b6","c6","d6","e6","f6","g6","h6","a7","b7","c7","d7","e7","f7","g7","h7","a8","b8","c8","d8","e8","f8","g8","h8"],c=function(){function e(){a()(this,e),this.squares=new Array(64).fill(null),this.orientation=null,this.markers=[],this.arrows=[]}return o()(e,[{key:"setPiece",value:function(e,t){this.squares[e]=t}},{key:"addMarker",value:function(e,t){this.markers.push({index:e,type:t})}},{key:"removeMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.markers=null===e&&null===t?[]:this.markers.filter((function(n){if(null===n.type){if(e===n.index)return!1}else if(null===e){if(n.type===t)return!1}else if(n.type===t&&e===n.index)return!1;return!0}))}},{key:"addArrow",value:function(e,t,n,r){this.arrows.push({from:e,to:t,move:n,attributes:r})}},{key:"removeArrows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.arrows=null===e?[]:this.arrows.filter((function(t){return t.type!==e}))}},{key:"setPosition",value:function(e){if(e)for(var t=e.replace(/^\s*/,"").replace(/\s*$/,"").split(/\/|\s/),n=0;n<8;n++)for(var r=t[7-n].replace(/\d/g,(function(e){for(var t=parseInt(e),n="",r=0;r<t;r++)n+="-";return n})),a=0;a<8;a++){var i=r.substr(a,1),o=null;"-"!==i&&(o=i.toUpperCase()===i?"w".concat(i.toLowerCase()):"b".concat(i)),this.squares[8*n+a]=o}}},{key:"getPosition",value:function(){for(var e=new Array(8).fill(""),t=0;t<8;t++){for(var n=0,r=0;r<8;r++){var a=this.squares[8*t+r];if(null===a)n++;else{n>0&&(e[7-t]+=n,n=0);var i=a.substr(0,1),o=a.substr(1,1);e[7-t]+="w"===i?o.toUpperCase():o}}n>0&&(e[7-t]+=n,n=0)}return e.join("/")}},{key:"squareToIndex",value:function(e){var t=e.substr(0,1).charCodeAt(0)-97;return 8*(e.substr(1,1)-1)+t}}]),e}(),u={waitForInputStart:0,pieceClickedThreshold:1,clickTo:2,secondClickThreshold:3,dragTo:4,clickDragTo:5,moveDone:6,reset:7},l=function(){function e(t,n,r,i,o,s){a()(this,e),this.view=t,this.state=n,this.props=r,this.moveStartCallback=i,this.moveDoneCallback=o,this.moveCanceledCallback=s,this.setMoveInputState(u.waitForInputStart)}return o()(e,[{key:"setMoveInputState",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.moveInputState;switch(this.moveInputState=e,e){case u.waitForInputStart:break;case u.pieceClickedThreshold:if(u.waitForInputStart!==r)throw new Error("moveInputState");if(this.startIndex=n.index,this.endIndex=null,this.movedPiece=n.piece,this.updateStartEndMarkers(),this.startPoint=n.point,this.pointerMoveListener||this.pointerUpListener)throw Error("_pointerMoveListener or _pointerUpListener");if("mousedown"===n.type)this.pointerMoveListener=this.onPointerMove.bind(this),this.pointerMoveListener.type="mousemove",window.addEventListener("mousemove",this.pointerMoveListener),this.pointerUpListener=this.onPointerUp.bind(this),this.pointerUpListener.type="mouseup",window.addEventListener("mouseup",this.pointerUpListener);else{if("touchstart"!==n.type)throw Error("event type");this.pointerMoveListener=this.onPointerMove.bind(this),this.pointerMoveListener.type="touchmove",window.addEventListener("touchmove",this.pointerMoveListener),this.pointerUpListener=this.onPointerUp.bind(this),this.pointerUpListener.type="touchend",window.addEventListener("touchend",this.pointerUpListener)}break;case u.clickTo:this.dragablePiece&&(k.removeElement(this.dragablePiece),this.dragablePiece=null),r===u.dragTo&&this.view.setPieceVisibility(n.index);break;case u.secondClickThreshold:if(u.clickTo!==r)throw new Error("moveInputState");this.startPoint=n.point;break;case u.dragTo:if(u.pieceClickedThreshold!==r)throw new Error("moveInputState");this.props.moveInputMode===O.dragPiece&&(this.view.setPieceVisibility(n.index,!1),this.createDragablePiece(n.piece));break;case u.clickDragTo:if(u.secondClickThreshold!==r)throw new Error("moveInputState");this.props.moveInputMode===O.dragPiece&&(this.view.setPieceVisibility(n.index,!1),this.createDragablePiece(n.piece));break;case u.moveDone:if(-1===[u.dragTo,u.clickTo,u.clickDragTo].indexOf(r))throw new Error("moveInputState");if(this.endIndex=n.index,this.endIndex&&this.moveDoneCallback(this.startIndex,this.endIndex)){var a=this.state.squares.slice(0);this.state.setPiece(this.startIndex,null),this.state.setPiece(this.endIndex,this.movedPiece),r===u.clickTo?this.view.animatePieces(a,this.state.squares.slice(0),(function(){t.setMoveInputState(u.reset)})):(this.view.drawPieces(this.state.squares),this.setMoveInputState(u.reset))}else this.view.drawPiecesDebounced(),this.setMoveInputState(u.reset);break;case u.reset:this.startIndex&&!this.endIndex&&this.movedPiece&&this.state.setPiece(this.startIndex,this.movedPiece),this.startIndex=null,this.endIndex=null,this.movedPiece=null,this.updateStartEndMarkers(),this.dragablePiece&&(k.removeElement(this.dragablePiece),this.dragablePiece=null),this.pointerMoveListener&&(window.removeEventListener(this.pointerMoveListener.type,this.pointerMoveListener),this.pointerMoveListener=null),this.pointerUpListener&&(window.removeEventListener(this.pointerUpListener.type,this.pointerUpListener),this.pointerUpListener=null),this.setMoveInputState(u.waitForInputStart);break;default:throw Error("moveInputState ".concat(e))}}},{key:"createDragablePiece",value:function(e){if(this.dragablePiece)throw Error("dragablePiece exists");this.dragablePiece=k.createSvg(document.body),this.dragablePiece.setAttribute("width",this.view.squareWidth),this.dragablePiece.setAttribute("height",this.view.squareHeight),this.dragablePiece.setAttribute("style","pointer-events: none"),this.dragablePiece.name=e;var t=k.addElement(this.dragablePiece,"use",{href:"#".concat(e)}),n=this.view.squareHeight/this.props.sprite.grid,r=this.dragablePiece.createSVGTransform();r.setScale(n,n),t.transform.baseVal.appendItem(r)}},{key:"moveDragablePiece",value:function(e,t){this.dragablePiece.setAttribute("style","pointer-events: none; position: absolute; left: ".concat(e-this.view.squareHeight/2,"px; top: ").concat(t-this.view.squareHeight/2,"px"))}},{key:"onPointerDown",value:function(e){if("mousedown"===e.type&&0===e.button||"touchstart"===e.type){var t,n,r,a=e.target.getAttribute("data-index"),i=this.view.getPiece(a);if(void 0!==a)if(i&&(n=(t=i.getAttribute("data-piece"))?t.substr(0,1):null),this.moveInputState!==u.waitForInputStart||this.state.inputWhiteEnabled&&"w"===n||this.state.inputBlackEnabled&&"b"===n)"mousedown"===e.type?r={x:e.clientX,y:e.clientY}:"touchstart"===e.type&&(r={x:e.touches[0].clientX,y:e.touches[0].clientY}),this.moveInputState===u.waitForInputStart&&t&&this.moveStartCallback(a)?this.setMoveInputState(u.pieceClickedThreshold,{index:a,piece:t,point:r,type:e.type}):this.moveInputState===u.clickTo&&(a===this.startIndex?this.setMoveInputState(u.secondClickThreshold,{index:a,piece:t,point:r,type:e.type}):this.setMoveInputState(u.moveDone,{index:a}))}}},{key:"onPointerMove",value:function(e){var t,n,r;if("mousemove"===e.type?(t=e.pageX,n=e.pageY,r=e.target):"touchmove"===e.type&&(t=e.touches[0].pageX,n=e.touches[0].pageY,r=document.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY)),this.moveInputState===u.pieceClickedThreshold||this.moveInputState===u.secondClickThreshold)(Math.abs(this.startPoint.x-t)>2||Math.abs(this.startPoint.y-n)>2)&&(this.moveInputState===u.secondClickThreshold?this.setMoveInputState(u.clickDragTo,{index:this.startIndex,piece:this.movedPiece}):this.setMoveInputState(u.dragTo,{index:this.startIndex,piece:this.movedPiece}),this.props.moveInputMode===O.dragPiece&&this.moveDragablePiece(t,n));else if(this.moveInputState===u.dragTo||this.moveInputState===u.clickDragTo||this.moveInputState===u.clickTo){if(r&&r.getAttribute&&r.parentElement===this.view.boardGroup){var a=r.getAttribute("data-index");a!==this.startIndex&&a!==this.endIndex?(this.endIndex=a,this.updateStartEndMarkers()):a===this.startIndex&&null!==this.endIndex&&(this.endIndex=null,this.updateStartEndMarkers())}else this.endIndex=null,this.updateStartEndMarkers();this.props.moveInputMode!==O.dragPiece||this.moveInputState!==u.dragTo&&this.moveInputState!==u.clickDragTo||this.moveDragablePiece(t,n)}}},{key:"onPointerUp",value:function(e){var t,n,r;if("mouseup"===e.type?r=e.target:"touchend"===e.type&&(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,r=document.elementFromPoint(t,n)),r&&r.getAttribute){var a=r.getAttribute("data-index");a?this.moveInputState===u.dragTo||this.moveInputState===u.clickDragTo?this.startIndex===a?this.moveInputState===u.clickDragTo?(this.state.setPiece(this.startIndex,this.movedPiece),this.view.setPieceVisibility(this.startIndex),this.setMoveInputState(u.reset)):this.setMoveInputState(u.clickTo,{index:a}):this.setMoveInputState(u.moveDone,{index:a}):this.moveInputState===u.pieceClickedThreshold?this.setMoveInputState(u.clickTo,{index:a}):this.moveInputState===u.secondClickThreshold&&(this.setMoveInputState(u.reset),this.moveCanceledCallback()):(this.view.drawPiecesDebounced(),this.setMoveInputState(u.reset),this.moveCanceledCallback())}else this.view.drawPiecesDebounced(),this.setMoveInputState(u.reset)}},{key:"updateStartEndMarkers",value:function(){this.state.removeMarkers(null,j.move),this.startIndex&&this.state.addMarker(this.startIndex,j.move),this.endIndex&&this.state.addMarker(this.endIndex,j.move),this.view.drawMarkersDebounced()}},{key:"destroy",value:function(){this.setMoveInputState(u.reset)}}]),e}(),d=0,p=1,f=2;function h(){}var m=function(){function e(t,n,r,i,o){if(a()(this,e),this.view=t,this.view.animationRunning)throw new h;n&&r&&(this.animatedElements=this.createAnimation(n,r),this.duration=i,this.callback=o,this.view.animationRunning=!0,this.frameHandle=requestAnimationFrame(this.animationStep.bind(this)))}return o()(e,[{key:"seekChanges",value:function(e,t){for(var n=this,r=[],a=[],i=[],o=0;o<64;o++){var s=e[o],c=t[o];c!==s&&(c&&r.push({piece:c,index:o}),s&&a.push({piece:s,index:o}))}return r.forEach((function(e){var t=8,r=null;a.forEach((function(a){if(e.piece===a.piece){var i=n.squareDistance(e.index,a.index);i<t&&(r=a,t=i)}})),r?(a.splice(a.indexOf(r),1),i.push({type:d,piece:e.piece,atIndex:r.index,toIndex:e.index})):i.push({type:p,piece:e.piece,atIndex:e.index})})),a.forEach((function(e){i.push({type:f,piece:e.piece,atIndex:e.index})})),i}},{key:"createAnimation",value:function(e,t){var n=this,r=this.seekChanges(e,t),a=[];return r.forEach((function(e){var t={type:e.type};switch(e.type){case d:t.element=n.view.getPiece(e.atIndex),t.atPoint=n.view.squareIndexToPoint(e.atIndex),t.toPoint=n.view.squareIndexToPoint(e.toIndex);break;case p:t.element=n.view.drawPiece(e.atIndex,e.piece),t.element.style.opacity=0;break;case f:t.element=n.view.getPiece(e.atIndex)}a.push(t)})),a}},{key:"animationStep",value:function(e){var t=this;this.startTime||(this.startTime=e);var n=e-this.startTime;n<=this.duration?this.frameHandle=requestAnimationFrame(this.animationStep.bind(this)):(cancelAnimationFrame(this.frameHandle),this.view.animationRunning=!1,this.callback());var r=Math.min(1,n/this.duration),a=r<.5?2*r*r:(4-2*r)*r-1;this.animatedElements.forEach((function(e){if(e.element)switch(e.type){case d:e.element.transform.baseVal.removeItem(0);var n=t.view.svg.createSVGTransform();n.setTranslate(e.atPoint.x+(e.toPoint.x-e.atPoint.x)*a,e.atPoint.y+(e.toPoint.y-e.atPoint.y)*a),e.element.transform.baseVal.appendItem(n);break;case p:e.element.style.opacity=a;break;case f:e.element.style.opacity=1-a}else console.warn("animatedItem has no element",e)}))}},{key:"squareDistance",value:function(e,t){var n=e%8,r=Math.floor(e/8),a=t%8,i=Math.floor(t/8);return Math.max(Math.abs(i-r),Math.abs(a-n))}}]),e}(),v=1,g=2,b=3,w=function(){function e(t,n){var r=this;a()(this,e),this.animationRunning=!1,this.currentAnimation=null,this.chessboard=t,this.spriteLoadWaitingTries=0,this.loadSprite(t.props,(function(){r.spriteLoadWaitDelay=0,r.moveInput=new l(r,t.state,t.props,r.moveStartCallback.bind(r),r.moveDoneCallback.bind(r),r.moveCanceledCallback.bind(r)),r.animationQueue=[],t.props.responsive&&(r.resizeListener=r.handleResize.bind(r),window.addEventListener("resize",r.resizeListener)),t.props.moveInputMode!==O.viewOnly&&(r.pointerDownListener=r.pointerDownHandler.bind(r),r.chessboard.element.addEventListener("mousedown",r.pointerDownListener),r.chessboard.element.addEventListener("touchstart",r.pointerDownListener)),r.createSvgAndGroups(),r.updateMetrics(),n()}))}return o()(e,[{key:"pointerDownHandler",value:function(e){e.preventDefault(),this.moveInput.onPointerDown(e)}},{key:"destroy",value:function(){this.moveInput.destroy(),window.removeEventListener("resize",this.resizeListener),this.chessboard.element.removeEventListener("mousedown",this.pointerDownListener),this.chessboard.element.removeEventListener("touchstart",this.pointerDownListener),window.clearTimeout(this.resizeDebounce),window.clearTimeout(this.redrawDebounce),window.clearTimeout(this.drawPiecesDebounce),window.clearTimeout(this.drawMarkersDebounce),window.clearTimeout(this.drawArrowssDebounce),k.removeElement(this.svg),this.animationQueue=[],this.currentAnimation&&cancelAnimationFrame(this.currentAnimation.frameHandle)}},{key:"loadSprite",value:function(t,n){var r=this;e.spriteLoadingStatus===v?(e.spriteLoadingStatus=g,k.loadSprite(t.sprite.url,["wk","wq","wr","wb","wn","wp","bk","bq","br","bb","bn","bp","marker1","marker2","marker3"].concat(t.sprite.markers),(function(){e.spriteLoadingStatus=b,n()}),t.sprite.grid)):e.spriteLoadingStatus===g?(setTimeout((function(){r.spriteLoadWaitingTries++,r.spriteLoadWaitingTries<50?r.loadSprite(t,n):console.error("timeout loading sprite",t.sprite.url)}),this.spriteLoadWaitDelay),this.spriteLoadWaitDelay+=10):e.spriteLoadingStatus===b?n():console.error("error ChessboardView.spriteLoadingStatus",e.spriteLoadingStatus)}},{key:"createSvgAndGroups",value:function(){this.svg&&k.removeElement(this.svg),this.svg=k.createSvg(this.chessboard.element);var e=this.chessboard.props.style.cssClass?this.chessboard.props.style.cssClass:"default";this.chessboard.props.style.showBorder?this.svg.setAttribute("class","cm-chessboard has-border "+e):this.svg.setAttribute("class","cm-chessboard "+e),this.updateMetrics(),this.boardGroup=k.addElement(this.svg,"g",{class:"board"}),this.coordinatesGroup=k.addElement(this.svg,"g",{class:"coordinates"}),this.markersGroup=k.addElement(this.svg,"g",{class:"markers"}),this.arrowsGroup=k.addElement(this.svg,"g",{class:"caissa-arrows"}),this.piecesGroup=k.addElement(this.svg,"g",{class:"pieces"})}},{key:"updateMetrics",value:function(){this.width=this.chessboard.element.offsetWidth,this.height=this.chessboard.element.offsetHeight,this.chessboard.props.style.showBorder?this.borderSize=this.width/32:this.borderSize=this.width/320,this.innerWidth=this.width-2*this.borderSize,this.innerHeight=this.height-2*this.borderSize,this.squareWidth=this.innerWidth/8,this.squareHeight=this.innerHeight/8,this.scalingX=this.squareWidth/this.chessboard.props.sprite.grid,this.scalingY=this.squareHeight/this.chessboard.props.sprite.grid,this.pieceXTranslate=this.squareWidth/2-this.chessboard.props.sprite.grid*this.scalingY/2}},{key:"handleResize",value:function(){var e=this;window.clearTimeout(this.resizeDebounce),this.resizeDebounce=setTimeout((function(){e.chessboard.element.offsetWidth===e.width&&e.chessboard.element.offsetHeight===e.height||(e.updateMetrics(),e.redraw()),e.svg.setAttribute("width","100%"),e.svg.setAttribute("height","100%")}))}},{key:"redraw",value:function(){var e=this;return new Promise((function(t){window.clearTimeout(e.redrawDebounce),e.redrawDebounce=setTimeout((function(){e.boardGroup&&(e.drawBoard(),e.drawCoordinates(),e.drawMarkers(),e.drawArrows(),e.setCursor())})),e.drawPiecesDebounced(e.chessboard.state.squares,(function(){t()}))}))}},{key:"drawBoard",value:function(){for(;this.boardGroup.firstChild;)this.boardGroup.removeChild(this.boardGroup.lastChild);if(k.addElement(this.boardGroup,"rect",{width:this.width,height:this.height}).setAttribute("class","border"),this.chessboard.props.style.showBorder){var e=this.borderSize-this.borderSize/9;k.addElement(this.boardGroup,"rect",{x:e,y:e,width:this.width-2*e,height:this.height-2*e}).setAttribute("class","border-inner")}for(var t=0;t<64;t++){var n=this.chessboard.state.orientation===x.white?t:63-t,r="square ".concat(0==(9*n&8)?"black":"white"),a=this.squareIndexToPoint(n),i=k.addElement(this.boardGroup,"rect",{x:a.x,y:a.y,width:this.squareWidth,height:this.squareHeight});i.setAttribute("class",r),i.setAttribute("data-index",""+n)}}},{key:"drawCoordinates",value:function(){if(this.chessboard.props.style.showCoordinates){for(;this.coordinatesGroup.firstChild;)this.coordinatesGroup.removeChild(this.coordinatesGroup.lastChild);for(var e=!this.chessboard.props.style.showBorder,t=0;t<8;t++){var n=this.borderSize+(18+this.chessboard.props.sprite.grid*t)*this.scalingX,r=this.height-2.6*this.scalingY,a="coordinate file";e&&(n+=15.5*this.scalingX,this.chessboard.props.style.showBorder&&(r-=11*this.scalingY),a+=t%2?" dark":" light");var i=k.addElement(this.coordinatesGroup,"text",{class:a,x:n,y:r,style:"font-size: ".concat(8*this.scalingY,"px")});this.chessboard.state.orientation===x.white?i.textContent=String.fromCharCode(97+t):i.textContent=String.fromCharCode(104-t)}for(var o=0;o<8;o++){var s=this.borderSize/3.7,c=this.borderSize+24*this.scalingY+o*this.squareHeight,u="coordinate rank";e&&(u+=o%2?" light":" dark",this.chessboard.props.style.showBorder?(s+=10*this.scalingX,c-=15*this.scalingY):(s+=2*this.scalingX,c-=15*this.scalingY));var l=k.addElement(this.coordinatesGroup,"text",{class:u,x:s,y:c,style:"font-size: ".concat(8*this.scalingY,"px")});this.chessboard.state.orientation===x.white?l.textContent=8-o:l.textContent=1+o}}}},{key:"drawPiecesDebounced",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chessboard.state.squares,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;window.clearTimeout(this.drawPiecesDebounce),this.drawPiecesDebounce=setTimeout((function(){e.drawPieces(t),n&&n()}))}},{key:"drawPieces",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chessboard.state.squares;if(this.piecesGroup){for(;this.piecesGroup.firstChild;)this.piecesGroup.removeChild(this.piecesGroup.lastChild);for(var t=0;t<64;t++){var n=e[t];n&&this.drawPiece(t,n)}}}},{key:"drawPiece",value:function(e,t){var n=k.addElement(this.piecesGroup,"g");n.setAttribute("data-piece",t),n.setAttribute("data-index",e);var r=this.squareIndexToPoint(e),a=this.svg.createSVGTransform();a.setTranslate(r.x,r.y),n.transform.baseVal.appendItem(a);var i=k.addElement(n,"use",{href:"#".concat(t),class:"piece"}),o=this.svg.createSVGTransform();o.setTranslate(this.pieceXTranslate,0),i.transform.baseVal.appendItem(o);var s=this.svg.createSVGTransform();return s.setScale(this.scalingY,this.scalingY),i.transform.baseVal.appendItem(s),n}},{key:"setPieceVisibility",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getPiece(e);t?n.setAttribute("visibility","visible"):n.setAttribute("visibility","hidden")}},{key:"getPiece",value:function(e){return this.piecesGroup.querySelector("g[data-index='".concat(e,"']"))}},{key:"drawMarkersDebounced",value:function(){var e=this;window.clearTimeout(this.drawMarkersDebounce),this.drawMarkersDebounce=setTimeout((function(){e.drawMarkers()}),10)}},{key:"drawMarkers",value:function(){var e=this;if(this.markersGroup){for(;this.markersGroup.firstChild;)this.markersGroup.removeChild(this.markersGroup.firstChild);this.chessboard.state.markers.forEach((function(t){e.drawMarker(t)}))}}},{key:"drawMarker",value:function(e){var t=k.addElement(this.markersGroup,"g");t.setAttribute("data-index",e.index);var n=this.squareIndexToPoint(e.index),r=this.svg.createSVGTransform();r.setTranslate(n.x,n.y),t.transform.baseVal.appendItem(r);var a=k.addElement(t,"use",{href:"#".concat(e.type.slice),class:"marker "+e.type.class}),i=this.svg.createSVGTransform();return i.setScale(this.scalingX,this.scalingY),a.transform.baseVal.appendItem(i),t}},{key:"drawArrowsDebounced",value:function(){var e=this;window.clearTimeout(this.drawArrowsDebounce),this.drawArrowsDebounce=setTimeout((function(){e.drawArrows()}),10)}},{key:"drawArrows",value:function(){var e=this;if(this.arrowsGroup){for(;this.arrowsGroup.firstChild;)this.arrowsGroup.removeChild(this.arrowsGroup.firstChild);this.chessboard.state.arrows.forEach((function(t){e.drawArrow(t)}))}}},{key:"calcAngle",value:function(e,t,n,r){return e===n&&t<r?0:e>n&&t===r?90:e===n&&t>r?180:e<n&&t===r?270:e>n&&t<r?45:e>n&&t>r?135:e<n&&t>r?225:e<n&&t<r?315:22}},{key:"addPolyline",value:function(e,t){var n=k.addElement(e,"polyline");return n.setAttribute("points",t),n}},{key:"drawArrow",value:function(e){var t,n,r,a,i=k.addElement(this.arrowsGroup,"g",{class:e.attributes.class}),o=this.svg.createSVGTransform(),s=this.svg.createSVGTransform(),c=this.svg.createSVGTransform(),u=this.squareIndexToPoint(e.from),l=this.squareIndexToPoint(e.to),d=this.chessboard.props.sprite.grid/2,p=d/2,f=(u.x-l.x)/this.scalingX,h=(u.y-l.y)/this.scalingY,m=d-f,v=d-h,g=Math.abs(f)>Math.abs(h)?m:d,b=Math.abs(f)>Math.abs(h)?d:v;return e.attributes.onclick&&(i.addEventListener("click",e.attributes.onclick),i.addEventListener("touchstart",e.attributes.onclick)),o.setTranslate(u.x,u.y),i.transform.baseVal.appendItem(o),s.setScale(this.scalingX,this.scalingY),Math.abs(h)===Math.abs(f)||0===h||0===f?(n=this.addPolyline(i,"".concat(d,",").concat(d," ").concat(m,",").concat(v)),a=this.addPolyline(i,"".concat(m-10,",").concat(v-10," ").concat(m,",").concat(v," ").concat(m+10,",").concat(v-10)),t=this.calcAngle(u.x,u.y,l.x,l.y)):(n=this.addPolyline(i,"".concat(d,",").concat(d," ").concat(g,",").concat(b)),r=this.addPolyline(i,"".concat(g,",").concat(b," ").concat(m,",").concat(v)),a=this.addPolyline(i,"".concat(m-p,",").concat(v-p," ").concat(m,",").concat(v," ").concat(m+p,",").concat(v-p)),t=this.calcAngle(g,b,m,v),r.transform.baseVal.appendItem(s)),c.setRotate(t,m,v),n.transform.baseVal.appendItem(s),a.transform.baseVal.appendItem(s),a.transform.baseVal.appendItem(c),i}},{key:"animatePieces",value:function(e,t,n){this.animationQueue.push({fromSquares:e,toSquares:t,callback:n}),this.animationRunning||this.nextPieceAnimationInQueue()}},{key:"nextPieceAnimationInQueue",value:function(){var e=this,t=this.animationQueue.shift();void 0!==t&&(this.currentAnimation=new m(this,t.fromSquares,t.toSquares,this.chessboard.props.animationDuration/(this.animationQueue.length+1),(function(){e.moveInput.dragablePiece||e.drawPieces(t.toSquares),e.nextPieceAnimationInQueue(),t.callback&&t.callback()})))}},{key:"moveStartCallback",value:function(e){return!this.chessboard.moveInputCallback||this.chessboard.moveInputCallback({chessboard:this.chessboard,type:P.moveStart,square:s[e]})}},{key:"moveDoneCallback",value:function(e,t){return!this.chessboard.moveInputCallback||this.chessboard.moveInputCallback({chessboard:this.chessboard,type:P.moveDone,squareFrom:s[e],squareTo:s[t]})}},{key:"moveCanceledCallback",value:function(){this.chessboard.moveInputCallback&&this.chessboard.moveInputCallback({chessboard:this.chessboard,type:P.moveCanceled})}},{key:"setCursor",value:function(){var e=this;this.chessboard.initialization.then((function(){e.chessboard.state.inputWhiteEnabled||e.chessboard.state.inputBlackEnabled?e.boardGroup.setAttribute("class","board input-enabled"):e.boardGroup.setAttribute("class","board")}))}},{key:"squareIndexToPoint",value:function(e){var t,n;return this.chessboard.state.orientation===x.white?(t=this.borderSize+e%8*this.squareWidth,n=this.borderSize+(7-Math.floor(e/8))*this.squareHeight):(t=this.borderSize+(7-e%8)*this.squareWidth,n=this.borderSize+Math.floor(e/8)*this.squareHeight),{x:t,y:n}}}]),e}(),y="http://www.w3.org/2000/svg",k=function(){function e(){a()(this,e)}return o()(e,null,[{key:"createSvg",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=document.createElementNS(y,"svg");return e&&(t.setAttribute("width","100%"),t.setAttribute("height","100%"),e.appendChild(t)),t}},{key:"addElement",value:function(e,t,n){var r=document.createElementNS(y,t);for(var a in"use"===t&&(n["xlink:href"]=n.href),n)if(-1!==a.indexOf(":")){var i=a.split(":");r.setAttributeNS("http://www.w3.org/1999/"+i[0],i[1],n[a])}else r.setAttribute(a,n[a]);return e.appendChild(r),r}},{key:"removeElement",value:function(e){e.parentNode.removeChild(e)}},{key:"loadSprite",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=new XMLHttpRequest;i.open("GET",e),i.send(),i.onload=function(){var e=i.response,o=(new DOMParser).parseFromString(e,"image/svg+xml"),s=r.createSvg(document.body);s.setAttribute("style","display: none");var c=r.addElement(s,"defs");t.forEach((function(e){var t=o.getElementById(e);if(t){for(var n=t.transform.baseVal,r=0;r<n.numberOfItems;r++){var i=n.getItem(r);2===i.type&&i.setTranslate(i.matrix.e%a,i.matrix.f%a)}!function e(t){t.forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&(t.removeAttribute("id"),t.hasChildNodes()&&e(t.childNodes))}))}(t.childNodes),c.appendChild(t)}else console.error("error, node id="+e+" not found in sprite")})),n(s)}}}]),e}();w.spriteLoadingStatus=v;var x={white:"w",black:"b"},O={viewOnly:0,dragPiece:1,dragMarker:2},P={moveStart:"moveStart",moveDone:"moveDone",moveCanceled:"moveCanceled",context:"context"},j={move:{class:"move",slice:"marker1"},emphasize:{class:"emphasize",slice:"marker2"},pointer:{class:"pointer",slice:"marker3"},rectwhite:{class:"rectwhite",slice:"marker4"},rectblack:{class:"rectblack",slice:"marker5"}},S="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",D=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;a()(this,e),this.element=t,this.props={position:"empty",orientation:x.white,style:{cssClass:"default",showCoordinates:!0,showBorder:!1},responsive:!1,animationDuration:300,moveInputMode:O.viewOnly,sprite:{url:"./assets/images/chessboard-sprite.svg",grid:40}},Object.assign(this.props,r),this.props.sprite.grid||(this.props.sprite.grid=40),this.state=new c,this.state.orientation=this.props.orientation,this.initialization=new Promise((function(e){n.view=new w(n,(function(){"start"===n.props.position?n.state.setPosition(S):"empty"===n.props.position||null===n.props.position?n.state.setPosition("8/8/8/8/8/8/8/8"):n.state.setPosition(n.props.position),setTimeout((function(){n.view.redraw().then((function(){e()}))}))}))})).then((function(){i&&(console.warn("warning: the constructor callback is deprecated and will be removed in future versions"),i(n))}))}return o()(e,[{key:"setPiece",value:function(e,t){var n=this;return new Promise((function(r){n.initialization.then((function(){n.state.setPiece(n.state.squareToIndex(e),t),n.view.drawPiecesDebounced(n.state.squares,(function(){r()}))}))}))}},{key:"getPiece",value:function(e){return this.state.squares[this.state.squareToIndex(e)]}},{key:"setPosition",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(r){t.initialization.then((function(){var a=t.state.getPosition();if(e.split(" ")[0]!==a){var i=t.state.squares.slice(0);"start"===e?t.state.setPosition(S):"empty"===e||null===e?t.state.setPosition("8/8/8/8/8/8/8/8"):t.state.setPosition(e),n?t.view.animatePieces(i,t.state.squares.slice(0),(function(){r()})):(t.view.drawPiecesDebounced(),r())}else r()}))}))}},{key:"getPosition",value:function(){return this.state.getPosition()}},{key:"addMarker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.emphasize;this.state.addMarker(this.state.squareToIndex(e),t),this.view.drawMarkersDebounced()}},{key:"addArrow",value:function(e,t,n){this.state.addArrow(this.state.squareToIndex(e),this.state.squareToIndex(t),e+t,n),this.view.drawArrowsDebounced()}},{key:"getMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];return this.state.markers.forEach((function(r){var a=s[r.index];(null===e&&(null===t||t===r.type)||null===t&&e===a||t===r.type&&e===a)&&n.push({square:s[r.index],type:r.type})})),n}},{key:"removeMarkers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!==e?this.state.squareToIndex(e):null;this.state.removeMarkers(n,t),this.view.drawMarkersDebounced()}},{key:"removeArrows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.state.removeArrows(e),this.view.drawArrowsDebounced()}},{key:"setOrientation",value:function(e){this.state.orientation=e,this.view.redraw()}},{key:"getOrientation",value:function(){return this.state.orientation}},{key:"destroy",value:function(){var e=this;return new Promise((function(t){e.initialization.then((function(){e.view.destroy(),e.view=null,e.state=null,e.element.removeEventListener("contextmenu",e.contextMenuListener),t()}))}))}},{key:"enableMoveInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.props.moveInputMode===O.viewOnly)throw Error("props.moveInputMode is MOVE_INPUT_MODE.viewOnly");t===x.white?this.state.inputWhiteEnabled=!0:(t===x.black||(this.state.inputWhiteEnabled=!0),this.state.inputBlackEnabled=!0),this.moveInputCallback=e,this.view.setCursor()}},{key:"disableMoveInput",value:function(){this.state.inputWhiteEnabled=!1,this.state.inputBlackEnabled=!1,this.moveInputCallback=null,this.view.setCursor()}},{key:"enableContextInput",value:function(e){this.contextMenuListener?console.warn("contextMenuListener already existing"):(this.contextMenuListener=function(t){t.preventDefault();var n=t.target.getAttribute("data-index");e({chessboard:this,type:P.context,square:s[n]})},this.element.addEventListener("contextmenu",this.contextMenuListener))}},{key:"disableContextInput",value:function(){this.element.removeEventListener("contextmenu",this.contextMenuListener)}}]),e}()},ziqU:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("NthX"),a=n.n(r),i=n("fFdx"),o=n.n(i),s=n("uoUx"),c=n.n(s),u=n("ohXN"),l=n("07Fe"),d=n("XasM"),p=n("Jnlq"),f=d.a.connect({name:"play-controller"}),h={doprocess:!1,slots:[],chess:new c.a,stop:function(){h.process=!1},start:function(e){return h.slots.forEach((function(e){return e.idle=!0})),Promise.all(l.a.request(2).map((function(e){return e.engine.init().then((function(e){return e.isready()})).then((function(e){return e.ucinewgame()})).then((function(){return e}))}))).then((function(t){h.slots=t,h.process=!0,h.chess=new c.a,h.white.engine=t[0].engine,h.black.engine=t[1].engine,t[0].name="white",t[1].name="black",f("board","fen",[h.chess.fen()]),u.a.start(e),u.a.over=function(e,t){h.finish("play.time.over",e,t)},h.white.tomove()}))},finish:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=console).log.apply(t,["controller.finish",e].concat(r)),h.process=!1,h.slots.forEach((function(e){return e.idle=!0})),!1},validates:function(e){var t=e.bestmove,n=h.chess.move(t,{sloppy:!0});return h.chess.game_over()?h.finish("game.over",n):n?(f("board","fen",[h.chess.fen()]),h.process):"(none)"===t?h.finish("game.over",t):h.finish("illegal move",t)},white:{engine:null,tomove:function(){return o()(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.b.sleep(1e3);case 2:return e.next=4,h.white.engine.position(h.chess.fen());case 4:return e.next=6,h.white.engine.go({depth:4});case 6:t=e.sent,h.validates(t)&&(u.a.whiteclick(),h.black.tomove());case 8:case"end":return e.stop()}}),e)})))()}},black:{engine:null,tomove:function(){return o()(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.b.sleep(1e3);case 2:return e.next=4,h.black.engine.position(h.chess.fen());case 4:return e.next=6,h.black.engine.go({depth:4});case 6:t=e.sent,h.validates(t)&&(u.a.blackclick(),h.white.tomove());case 8:case"end":return e.stop()}}),e)})))()}}}}},[["QfWi",2,3,0]]]);